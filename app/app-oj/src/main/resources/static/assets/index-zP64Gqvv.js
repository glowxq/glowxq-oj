import{h as T,O as x,d as Ve,p as ke,s as we,b as C,bk as G,bl as De,aB as Se,r as c,bm as Ee,e as Ue,f as m,g as Pe,o as _,c as M,a as s,j as a,k as n,u as p,az as J,bn as $e,n as j,i as k,N as Ae,bo as Ie,y as q,bp as ze,x as y,a_ as Ne,a$ as Me,bq as Be,t as Q,br as Fe,bs as Le,D as Ye,b0 as Oe,P as Re,Q as He,W as $,aa as Ge,_ as Je}from"./index-DTkCE7MD.js";import je from"./time-3HTQ8mLx.js";import{u as W}from"./useHandleData-BdxQ-8Ab.js";import qe from"./CourseForm-B_s9h6ih.js";import Qe from"./CourseCard-CFIaFqEv.js";import{I as We,u as Ke,d as Xe}from"./common-DxSkM119.js";import Ze from"./CourseDetailModal-DZAkB75I.js";import"./index-E5zgXN01.js";import"./style-DrPmFrlE.js";import"./upload-BtJOZC1L.js";import"./FileSaver.min-BnsyPtRb.js";import"./teacher-BaXmGp8W.js";import"./phone-AAKQdgK6.js";import"./note-09UWJrPN.js";import"./class-BWbqkwWR.js";const et=i=>T.post(x+"/course/list",i),tt=i=>T.post(x+"/course",i),at=i=>T.put(x+"/course",i),K=i=>T.delete(x+"/course",i),X=i=>{const{id:w}=i;return T.get(x+`/course/${w}`)},lt=(i,w)=>T.upload(x+"/course/import",i,w),ot=i=>T.download(x+"/course/export",i),st={class:"course-container"},nt={class:"search-title"},rt={class:"search-content"},it={class:"search-buttons"},ut={class:"operation-btns"},ct={class:"button-text"},dt={class:"pagination-info"},mt={class:"course-count"},pt={class:"course-cards"},ft={key:0,class:"empty-data"},vt={class:"pagination-container"},_t=Ve({name:"CourseView",__name:"index",setup(i){ke(t=>({"22a458e4":U.value,d5142394:A.value,"7ae0d250":B.value,"3900c8c6":Z.value,cde7892c:ee.value,"655e1dad":te.value,"451eb056":ae.value}));const w=we(),U=C(()=>w.primary),A=C(()=>G(U.value,.1)),B=C(()=>De(U.value,.1)),Z=C(()=>`linear-gradient(135deg, ${A.value}, ${B.value})`),ee=C(()=>`linear-gradient(135deg, ${G(U.value,.95)}, white)`),te=C(()=>"rgba(0, 0, 0, 0.1)"),ae=C(()=>`linear-gradient(90deg, ${A.value}, transparent)`),o=Se({name:"",content:"",url:"",teacherUserId:void 0,teacherName:void 0,teacherPhone:void 0,enable:void 0,startTime:void 0,endTime:void 0}),D=c(!0),F=c(),le=()=>{D.value=!D.value},b=c([]),V=c(1),P=c(8),I=c(0),r=c([]),h=c(!1),oe=()=>{h.value?(r.value=[],h.value=!1):(r.value=b.value.map(t=>t.id),h.value=!0)};Ee(()=>{b.value.length>0&&r.value.length===b.value.length?h.value=!0:h.value=!1});const f=async()=>{const t={...o,page:V.value,limit:P.value},e=L(t);try{const u=await et(e);b.value=u.data.rows||[],I.value=u.data.total||0}catch(u){console.error("获取课程列表失败:",u)}},se=()=>{V.value=1,f()},ne=()=>{var t;(t=F.value)==null||t.resetFields(),o.teacherUserId=void 0,o.teacherName=void 0,o.teacherPhone=void 0,V.value=1,f()},re=(t,e)=>{e?(o.teacherName=e.name,o.teacherPhone=e.phone):(o.teacherName=void 0,o.teacherPhone=void 0)},L=t=>{let e=JSON.parse(JSON.stringify(t));return e.startTime&&(e.startTimeStart=e.startTime[0]),e.startTime&&(e.startTimeEnd=e.startTime[1]),delete e.startTime,e.endTime&&(e.endTimeStart=e.endTime[0]),e.endTime&&(e.endTimeEnd=e.endTime[1]),delete e.endTime,e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},ie=t=>r.value.includes(t.id),ue=t=>{const e=r.value.indexOf(t.id);e>-1?r.value.splice(e,1):r.value.push(t.id)},ce=t=>{P.value=t,f()},de=t=>{V.value=t,f()},Y=c(),z=async(t,e={},u=!0)=>{var v;if(!u){const S=await X({id:e==null?void 0:e.id});e=S==null?void 0:S.data}const d={title:t,row:{...e},api:u?tt:at,getTableList:f};(v=Y.value)==null||v.acceptParams(d)},me=async t=>{const e=await X({id:t==null?void 0:t.id}),d={...e==null?void 0:e.data};delete d.id,d.name&&(d.name=`${d.name} (复制)`),z("新增课程",d,!0)},pe=async t=>{await W(K,{ids:[t.id]},`删除【${t.name||t.id}】课程`);const e=r.value.indexOf(t.id);e>-1&&r.value.splice(e,1),f()},fe=async t=>{await W(K,{ids:t},"删除所选课程"),r.value=[],f()},O=c(),ve=()=>{var e;const t={title:"课程",templateName:"课程",tempApi:Xe,importApi:lt,getTableList:f};(e=O.value)==null||e.acceptParams(t)},_e=async()=>{if(r.value.length!==1){$.warning("请选择一个课程");return}const t=r.value[0],e=b.value.find(u=>u.id===t);if(!e){$.error("未找到课程信息");return}if(!e.url){$.warning("该课程没有设置课程链接，无法开始上课");return}Ge.confirm(`确定开始【${e.name}】课程？将打开课程链接。`,"开始上课",{confirmButtonText:"开始上课",cancelButtonText:"取消",type:"info"}).then(()=>{window.open(e.url,"_blank"),$.success(`已开始【${e.name}】课程`)}).catch(()=>{})},ge=async()=>{let t={...o,page:1,limit:9999};const e=L(t);Ke(ot,"课程",e)},N=c(!1),R=c(null),be=t=>{R.value=t,N.value=!0};return Ue(()=>{f()}),(t,e)=>{const u=m("el-icon"),d=m("el-input"),v=m("el-form-item"),S=m("el-switch"),H=m("el-date-picker"),he=m("el-form"),g=m("el-button"),Ce=m("el-empty"),ye=m("el-col"),Te=m("el-row"),xe=m("el-pagination"),E=Pe("auth");return _(),M("div",st,[s("div",{class:j(["search-area",{"is-collapsed":D.value}])},[s("div",{class:"search-header",onClick:le},[s("div",nt,[a(u,{class:"search-icon"},{default:n(()=>[a(p(J))]),_:1}),e[12]||(e[12]=s("span",null,"搜索课程",-1))]),a(u,{class:j(["collapse-icon",{"is-rotate":!D.value}])},{default:n(()=>[a(p($e))]),_:1},8,["class"])]),k(s("div",rt,[a(he,{model:o,ref_key:"searchFormRef",ref:F,inline:!0,class:"search-form"},{default:n(()=>[a(v,{label:"课程名"},{default:n(()=>[a(d,{modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.name=l),placeholder:"请输入课程名",clearable:"",class:"cute-input"},null,8,["modelValue"])]),_:1}),a(v,{label:"课程内容"},{default:n(()=>[a(d,{modelValue:o.content,"onUpdate:modelValue":e[1]||(e[1]=l=>o.content=l),placeholder:"请输入课程内容",clearable:"",class:"cute-input"},null,8,["modelValue"])]),_:1}),a(v,{label:"课程链接"},{default:n(()=>[a(d,{modelValue:o.url,"onUpdate:modelValue":e[2]||(e[2]=l=>o.url=l),placeholder:"请输入课程链接",clearable:"",class:"cute-input"},null,8,["modelValue"])]),_:1}),a(v,{label:"授课老师",class:"special-form-item"},{default:n(()=>[a(Ie,{modelValue:o.teacherUserId,"onUpdate:modelValue":e[3]||(e[3]=l=>o.teacherUserId=l),placeholder:"请选择授课老师",clearable:"",onChange:re,class:"cute-select teacher-select"},null,8,["modelValue"])]),_:1}),a(v,{label:"启用状态"},{default:n(()=>[a(S,{modelValue:o.enable,"onUpdate:modelValue":e[4]||(e[4]=l=>o.enable=l),class:"cute-switch"},null,8,["modelValue"])]),_:1}),a(v,{label:"上课时间"},{default:n(()=>[a(H,{modelValue:o.startTime,"onUpdate:modelValue":e[5]||(e[5]=l=>o.startTime=l),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择上课时间范围",clearable:"",class:"cute-date-picker"},null,8,["modelValue"])]),_:1}),a(v,{label:"下课时间"},{default:n(()=>[a(H,{modelValue:o.endTime,"onUpdate:modelValue":e[6]||(e[6]=l=>o.endTime=l),type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择下课时间范围",clearable:"",class:"cute-date-picker"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",it,[a(g,{type:"primary",onClick:se,icon:p(J)},{default:n(()=>e[13]||(e[13]=[q(" 搜索 ")])),_:1},8,["icon"]),a(g,{onClick:ne,icon:p(ze)},{default:n(()=>e[14]||(e[14]=[q(" 重置 ")])),_:1},8,["icon"])])],512),[[Ae,!D.value]])],2),s("div",ut,[k((_(),y(g,{type:"primary",icon:p(Ne),onClick:e[7]||(e[7]=l=>z("新增课程")),class:"cute-button create-button"},{default:n(()=>e[15]||(e[15]=[s("span",{class:"button-text"},"新增课程",-1),s("span",{class:"button-effect"},null,-1)])),_:1},8,["icon"])),[[E,"course.create"]]),k((_(),y(g,{type:"danger",icon:p(Me),plain:"",disabled:r.value.length===0,onClick:e[8]||(e[8]=l=>fe(r.value)),class:"cute-button delete-button"},{default:n(()=>e[16]||(e[16]=[s("span",{class:"button-text"},"批量删除",-1),s("span",{class:"button-effect"},null,-1)])),_:1},8,["icon","disabled"])),[[E,"course.remove"]]),k((_(),y(g,{type:"success",icon:p(Be),plain:"",disabled:r.value.length!==1,onClick:_e,class:"cute-button start-button"},{default:n(()=>e[17]||(e[17]=[s("span",{class:"button-text"},"开始上课",-1),s("span",{class:"button-effect"},null,-1)])),_:1},8,["icon","disabled"])),[[E,"course.update"]]),a(g,{type:"info",icon:h.value?p(Fe):p(Le),plain:"",onClick:oe,class:"cute-button select-button"},{default:n(()=>[s("span",ct,Q(h.value?"取消全选":"全选"),1),e[18]||(e[18]=s("span",{class:"button-effect"},null,-1))]),_:1},8,["icon"]),k((_(),y(g,{type:"primary",icon:p(Ye),plain:"",onClick:ve,class:"cute-button import-button"},{default:n(()=>e[19]||(e[19]=[s("span",{class:"button-text"},"导入",-1),s("span",{class:"button-effect"},null,-1)])),_:1},8,["icon"])),[[E,"course.import"]]),k((_(),y(g,{type:"primary",icon:p(Oe),plain:"",onClick:ge,class:"cute-button export-button"},{default:n(()=>e[20]||(e[20]=[s("span",{class:"button-text"},"导出",-1),s("span",{class:"button-effect"},null,-1)])),_:1},8,["icon"])),[[E,"course.export"]])]),s("div",dt,[s("span",mt,"共 "+Q(I.value)+" 个课程",1)]),s("div",pt,[b.value.length===0?(_(),M("div",ft,[a(Ce,{description:"暂无课程数据","image-size":200},{image:n(()=>e[21]||(e[21]=[s("img",{src:je,class:"empty-icon"},null,-1)])),_:1})])):(_(),y(Te,{key:1,gutter:80},{default:n(()=>[(_(!0),M(Re,null,He(b.value,l=>(_(),y(ye,{key:l.id,xs:24,sm:12,md:8,lg:6,xl:5},{default:n(()=>[a(Qe,{course:l,onEdit:gt=>z("编辑课程",l,!1),onCopy:me,onDelete:pe,onSelect:ue,onViewDetails:be,"is-selected":ie(l)},null,8,["course","onEdit","is-selected"])]),_:2},1024))),128))]),_:1}))]),s("div",vt,[a(xe,{"current-page":V.value,"onUpdate:currentPage":e[9]||(e[9]=l=>V.value=l),"page-size":P.value,"onUpdate:pageSize":e[10]||(e[10]=l=>P.value=l),"page-sizes":[8,16,24,32],layout:"total, sizes, prev, pager, next, jumper",total:I.value,onSizeChange:ce,onCurrentChange:de,class:"cute-pagination"},null,8,["current-page","page-size","total"])]),a(qe,{ref_key:"courseRef",ref:Y},null,512),a(We,{ref_key:"ImportExcelRef",ref:O},null,512),a(Ze,{modelValue:N.value,"onUpdate:modelValue":e[11]||(e[11]=l=>N.value=l),course:R.value,onStartCourse:f},null,8,["modelValue","course"])])}}}),At=Je(_t,[["__scopeId","data-v-43fff5d5"]]);export{At as default};
