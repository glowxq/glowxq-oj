import{h as n,bF as d,d as P,r as g,f as M,g as R,o as s,c as h,j as T,k as i,i as m,x as c,u as b,a_ as j,y,a$ as I,D as N,b0 as Y,b1 as H}from"./index-DTkCE7MD.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as x}from"./useHandleData-BdxQ-8Ab.js";import{_ as B}from"./SysOperationLogForm.vue_vue_type_script_setup_true_lang-ENDCQHFI.js";import{I as F,d as V,u as J}from"./common-DxSkM119.js";import"./sortable.esm-Cw1ESr5Y.js";const U=o=>n.get(d+"/sys-operation-log/list",o),z=o=>n.post(d+"/sys-operation-log/create",o),G=o=>n.put(d+"/sys-operation-log/update",o),S=o=>n.delete(d+"/sys-operation-log/remove",o),K=o=>n.get(d+"/sys-operation-log/detail",o),Q=(o,p)=>n.upload(d+"/sys-operation-log/import",o,p),W=o=>n.download(d+"/sys-operation-log/export",o),X={class:"table-box"},le=P({name:"SysOperationLogView",__name:"index",setup(o){const p=g(),D=[{type:"selection",width:80},{prop:"userId",label:"用户id"},{prop:"traceId",label:"链路追踪ID"},{prop:"spanId",label:"业务模块跟踪ID"},{prop:"username",label:"用户名称"},{prop:"ip",label:"ip"},{prop:"method",label:"方法"},{prop:"uri",label:"接口"},{prop:"header",label:"请求头"},{prop:"module",label:"模块名称"},{prop:"description",label:"操作描述"},{prop:"param",label:"参数"},{prop:"request",label:"请求参数json"},{prop:"response",label:"响应参数json"},{prop:"error",label:"存在错误"},{prop:"businessType",label:"操作类型"},{prop:"errorMessage",label:"错误信息"},{prop:"costTime",label:"操作耗时（ms）"},{prop:"tenantId",label:"租户id"},{prop:"operation",label:"操作",width:250,fixed:"right"}],C=[{prop:"userId",label:"用户id",el:"input"},{prop:"traceId",label:"链路追踪ID",el:"input"},{prop:"spanId",label:"业务模块跟踪ID",el:"input"},{prop:"username",label:"用户名称",el:"input"},{prop:"ip",label:"ip",el:"input"},{prop:"method",label:"方法",el:"input"},{prop:"uri",label:"接口",el:"input"},{prop:"header",label:"请求头",el:"input"},{prop:"module",label:"模块名称",el:"input"},{prop:"description",label:"操作描述",el:"input"},{prop:"param",label:"参数",el:"input"},{prop:"request",label:"请求参数json",el:"input"},{prop:"response",label:"响应参数json",el:"input"},{prop:"error",label:"存在错误",el:"input"},{prop:"businessType",label:"操作类型",el:"select"},{prop:"errorMessage",label:"错误信息",el:"input"},{prop:"costTime",label:"操作耗时（ms）",el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"}},{prop:"tenantId",label:"租户id",el:"input"}],O=t=>{let e=_(t);return U(e)},_=t=>{let e=JSON.parse(JSON.stringify(t));return e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},v=g(),k=async(t,e={},a=!0)=>{var r,u;if(!a){const f=await K({id:e==null?void 0:e.id});e=f==null?void 0:f.data}const l={title:t,row:{...e},api:a?z:G,getTableList:(r=p.value)==null?void 0:r.getTableList};(u=v.value)==null||u.acceptParams(l)},w=async t=>{var e;await x(S,{ids:[t.id]},`删除【${t.id}】操作日志`),(e=p.value)==null||e.getTableList()},E=async t=>{var e,a;await x(S,{ids:t},"删除所选操作日志"),(e=p.value)==null||e.clearSelection(),(a=p.value)==null||a.getTableList()},L=g(),A=()=>{var e,a;const t={title:"操作日志",templateName:"操作日志",tempApi:V,importApi:Q,getTableList:(e=p.value)==null?void 0:e.getTableList};(a=L.value)==null||a.acceptParams(t)},$=async()=>{var e;let t=_((e=p.value)==null?void 0:e.searchParam);J(W,"操作日志",t)};return(t,e)=>{const a=M("el-button"),l=R("auth");return s(),h("div",X,[T(q,{ref_key:"proTableRef",ref:p,title:"操作日志",indent:20,columns:D,"search-columns":C,"request-api":O,"row-key":"id"},{tableHeader:i(r=>[m((s(),c(a,{type:"primary",icon:b(j),onClick:e[0]||(e[0]=u=>k("新增操作日志"))},{default:i(()=>e[1]||(e[1]=[y(" 新增 ")])),_:1},8,["icon"])),[[l,"sys.operation.log.create"]]),m((s(),c(a,{type:"danger",icon:b(I),plain:"",disabled:!r.isSelected,onClick:u=>E(r.selectedListIds)},{default:i(()=>e[2]||(e[2]=[y(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[l,"sys.operation.log.remove"]]),m((s(),c(a,{type:"primary",icon:b(N),plain:"",onClick:A},{default:i(()=>e[3]||(e[3]=[y(" 导入 ")])),_:1},8,["icon"])),[[l,"sys.operation.log.import"]]),m((s(),c(a,{type:"primary",icon:b(Y),plain:"",onClick:$},{default:i(()=>e[4]||(e[4]=[y(" 导出 ")])),_:1},8,["icon"])),[[l,"sys.operation.log.export"]])]),operation:i(({row:r})=>[m((s(),c(a,{type:"primary",link:"",icon:b(H),onClick:u=>k("编辑操作日志",r,!1)},{default:i(()=>e[5]||(e[5]=[y(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[l,"sys.operation.log.update"]]),m((s(),c(a,{type:"primary",link:"",icon:b(I),onClick:u=>w(r)},{default:i(()=>e[6]||(e[6]=[y(" 删除 ")])),_:2},1032,["icon","onClick"])),[[l,"sys.operation.log.remove"]])]),_:1},512),T(B,{ref_key:"sysOperationLogRef",ref:v},null,512),T(F,{ref_key:"ImportExcelRef",ref:L},null,512)])}}});export{le as default};
