import{d as Y,bc as Z,r as g,aB as ee,f as k,g as te,o,c as _,a as x,j as c,k as n,i as f,x as y,u as b,a_ as se,y as u,a$ as R,dL as U,t as v,P as D,Q as I,b1 as ae,F as ne,aQ as oe,m as h,ap as le,d$ as ie,e0 as re,e1 as de,e2 as ce,dM as ue,e3 as A,dN as S,W as E,aa as pe,dO as me,dP as _e,_ as fe}from"./index-DTkCE7MD.js";import{_ as ye}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as N}from"./useHandleData-BdxQ-8Ab.js";import{_ as be}from"./UserAdd.vue_vue_type_script_setup_true_lang-B4K0mlVJ.js";import{_ as ke}from"./UserEdit.vue_vue_type_script_setup_true_lang-BIQTKp6O.js";import{_ as ge}from"./UserPermissions.vue_vue_type_script_setup_true_lang-DOHFPSim.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-BNLs1B-2.js";import{_ as Ce}from"./UserDataPermissions.vue_vue_type_script_setup_true_lang-zewCWOQe.js";import"./sortable.esm-Cw1ESr5Y.js";import"./Img-CbqiKKTP.js";import"./upload-BtJOZC1L.js";const Le={class:"main-box"},Te={class:"table-box"},$e={key:1},Pe={class:"btn-group"},we={class:"el-dropdown"},xe=Y({name:"AccountManage",__name:"index",setup(Re){const B=Z(),V=[{type:"selection",width:55,selectable:t=>t.id!==1},{prop:"username",label:"账户",width:150,align:"left"},{prop:"nickname",label:"昵称",width:150,align:"left"},{prop:"phone",label:"手机号",width:120},{prop:"roleInfo",label:"角色"},{prop:"accountStatusCd",label:"状态",tag:!0,enum:B.getDictOptions("account_status"),width:80,fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"createTime",label:"创建时间",width:165},{prop:"operation",label:"操作",width:260,fixed:"right"}],M=[{prop:"username",label:"账户",el:"input"},{prop:"phone",label:"手机号",el:"input"}],p=g(),O=t=>ie(t),C=g(),j=t=>{var a,i;const e={title:t,row:{},api:re,getTableList:(a=p.value)==null?void 0:a.getTableList};(i=C.value)==null||i.acceptParams(e)},L=g(),F=async(t,e={})=>{var r,l;const{data:a}=await de({id:e.id}),i={title:t,row:{...a},api:ce,getTableList:(r=p.value)==null?void 0:r.getTableList};(l=L.value)==null||l.acceptParams(i)},T=g(),H=(t,e={})=>{var i,r,l;const a={title:t,row:e,api:ue,getTableList:(i=p.value)==null?void 0:i.getTableList};(r=T.value)==null||r.acceptParams(a),(l=p.value)==null||l.getTableList()},Q=async t=>{var e;await N(A,{ids:[t.id]},`删除【${t.username}】用户`),(e=p.value)==null||e.getTableList()},q=async t=>{var e,a;await N(A,{ids:t},"删除所选用户信息"),(e=p.value)==null||e.clearSelection(),(a=p.value)==null||a.getTableList()},$=async t=>{Array.isArray(t)?await S({ids:t}):await S({ids:[t]}),E.success("解锁成功！")},W=async t=>{const e={id:t==null?void 0:t.id};pe.confirm("您确认要重置账户 ["+t.username+"] 密码?","温馨提示",{type:"warning"}).then(async()=>{var a;await me(e),(a=p.value)==null||a.getTableList(),E.success({message:"账户 ["+t.username+"] 重置密码成功！",duration:5e3,showClose:!0})})},z=ee({}),P=t=>{if(t===null)return[];let e=[];return t.split(",").forEach(function(i){let r=i.split(":"),l={id:r[0],name:r[1]};e.push(l)}),e},w=g(),G=(t,e={})=>{var i,r,l;const a={title:t,row:e,api:_e,getTableList:(i=p.value)==null?void 0:i.getTableList};(r=w.value)==null||r.acceptParams(a),(l=p.value)==null||l.getTableList()};return(t,e)=>{const a=k("el-button"),i=k("el-image"),r=k("el-tag"),l=k("el-dropdown-item"),J=k("el-icon"),K=k("el-dropdown-menu"),X=k("el-dropdown"),m=te("auth");return o(),_("div",Le,[x("div",Te,[c(ye,{ref_key:"proTableRef",ref:p,title:"用户列表",indent:20,columns:V,"search-columns":M,"request-api":O,"search-col":4,"init-param":z,border:!1,"loading-time":200},{tableHeader:n(s=>[f((o(),y(a,{type:"primary",icon:b(se),onClick:e[0]||(e[0]=d=>j("新增用户"))},{default:n(()=>e[1]||(e[1]=[u(" 新增用户 ")])),_:1},8,["icon"])),[[m,"sys.user.create_btn"]]),f((o(),y(a,{type:"danger",icon:b(R),plain:"",disabled:!s.isSelected,onClick:d=>q(s.selectedListIds)},{default:n(()=>e[2]||(e[2]=[u(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[m,"sys.user.delete_btn"]]),c(a,{type:"info",icon:b(U),plain:"",disabled:!s.isSelected,onClick:d=>$(s.selectedListIds)},{default:n(()=>e[3]||(e[3]=[u(" 解锁 ")])),_:2},1032,["icon","disabled","onClick"])]),username:n(({row:s})=>[c(a,{type:"primary",link:""},{default:n(()=>[u(v(s==null?void 0:s.username),1)]),_:2},1024)]),logo:n(({row:s})=>[s.logo?(o(),y(i,{key:0,src:s.logo},null,8,["src"])):(o(),_("div",$e,"--"))]),deptInfo:n(({row:s})=>[(o(!0),_(D,null,I(P(s.deptInfo),d=>(o(),y(r,{class:"user-item",key:d.id,type:"info"},{default:n(()=>[u(v(d.name),1)]),_:2},1024))),128))]),roleInfo:n(({row:s})=>[(o(!0),_(D,null,I(P(s.roleInfo),d=>(o(),y(r,{class:"user-item",key:d.id,type:"info"},{default:n(()=>[u(v(d.name),1)]),_:2},1024))),128))]),operation:n(({row:s})=>[x("div",Pe,[f((o(),y(a,{type:"primary",link:"",icon:b(ae),onClick:d=>F("编辑用户",s)},{default:n(()=>e[4]||(e[4]=[u(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[m,"sys.user.update_btn"]]),f((o(),y(a,{type:"primary",icon:b(U),link:"",onClick:d=>$(s.id)},{default:n(()=>e[5]||(e[5]=[u(" 解锁 ")])),_:2},1032,["icon","onClick"])),[[m,"sys.user.unlock_btn"]]),f((o(),_("div",we,[c(X,{trigger:"click"},{dropdown:n(()=>[c(K,null,{default:n(()=>[f((o(),_("div",null,[c(l,{icon:b(ne),onClick:d=>H("设置角色",s)},{default:n(()=>e[7]||(e[7]=[u(" 设置角色 ")])),_:2},1032,["icon","onClick"])])),[[m,"sys.user.role_set_btn"]]),f((o(),_("div",null,[c(l,{type:"primary",icon:b(oe),link:"",onClick:d=>W(s)},{default:n(()=>e[8]||(e[8]=[u(" 重置密码 ")])),_:2},1032,["icon","onClick"])])),[[m,"sys.user.unlock_btn"]]),f((o(),_("div",null,[s.id!==1?(o(),y(l,{key:0,icon:b(R),onClick:d=>Q(s)},{default:n(()=>e[9]||(e[9]=[u(" 删除 ")])),_:2},1032,["icon","onClick"])):h("",!0)])),[[m,"sys.user.delete_btn"]]),f((o(),_("div",null,[s.id!==1?(o(),y(l,{key:0,type:"primary",onClick:d=>G("设置数据角色",s)},{default:n(()=>[c(J,{class:"el-icon--left"},{default:n(()=>[c(ve,{name:"scope"})]),_:1}),e[10]||(e[10]=u(" 设置数据角色 "))]),_:2},1032,["onClick"])):h("",!0)])),[[m,"sys.user.data_role_set_btn"]])]),_:2},1024)]),default:n(()=>[c(a,{type:"primary",link:"",icon:b(le)},{default:n(()=>e[6]||(e[6]=[u(" 更多 ")])),_:1},8,["icon"])]),_:2},1024)])),[[m,[{type:"or",conditions:["sys.user.unlock_btn","sys.user.role_set_btn","sys.user.delete_btn","sys.user.dept_set_btn","sys.user.data_scope_btn"]}]]])])]),_:1},8,["init-param"]),c(be,{ref_key:"userAddRef",ref:C},null,512),c(ke,{ref_key:"userEditRef",ref:L},null,512),c(ge,{ref_key:"userPermissionsRef",ref:T},null,512),c(Ce,{ref_key:"userDataPermissionsRef",ref:w},null,512)])])}}}),Oe=fe(xe,[["__scopeId","data-v-9d4bd452"]]);export{Oe as default};
