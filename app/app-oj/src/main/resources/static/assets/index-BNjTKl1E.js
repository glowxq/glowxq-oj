import{h as d,aP as u,d as O,bc as P,r as g,f as A,g as H,o as p,c as M,j as C,k as o,i as m,x as y,u as b,a_ as R,y as f,a$ as S,b1 as V,m as T}from"./index-DTkCE7MD.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as N}from"./useHandleData-BdxQ-8Ab.js";import{_ as B}from"./SysClientForm.vue_vue_type_script_setup_true_lang-C-DjXYin.js";import"./sortable.esm-Cw1ESr5Y.js";const E=l=>d.get(u+"/sys-client",l),F=l=>d.post(u+"/sys-client",l),J=l=>d.put(u+"/sys-client",l),D=l=>d.delete(u+"/sys-client",l),K=l=>{const{id:c}=l;return d.get(u+`/sys-client/${c}`)},j={class:"table-box"},W=O({name:"SysClientView",__name:"index",setup(l){const c=P(),r=g(),L=[{type:"selection",width:80,selectable:t=>t.isLock!=="T"},{prop:"clientId",label:"ClientId"},{prop:"clientKey",label:"客户端名称"},{prop:"clientSecret",label:"客户端秘钥"},{prop:"grantTypeCd",label:"授权类型",tag:!0,enum:c.getDictOptions("grant_type"),fieldNames:{label:"codeName",value:"alias",tagType:"callbackShowStyle"}},{prop:"deviceTypeCd",label:"设备类型",tag:!0,enum:c.getDictOptions("device_type"),fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"activeTimeout",label:"token活跃超时时间"},{prop:"timeout",label:"token固定超时"},{prop:"clientStatusCd",label:"状态",tag:!0,enum:c.getDictOptions("sys_client_status"),fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"remark",label:"备注"},{prop:"operation",label:"操作",width:250,fixed:"right"}],h=[{prop:"clientKey",label:"客户端名称",el:"input"},{prop:"clientSecret",label:"客户端秘钥",el:"input"},{prop:"grantTypeCd",label:"授权类型",el:"select",fieldNames:{label:"codeName",value:"alias",tagType:"callbackShowStyle"}},{prop:"deviceTypeCd",label:"设备类型",el:"select",fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"activeTimeout",label:"token活跃超时时间",el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"}}],I=t=>{let e=$(t);return E(e)},$=t=>JSON.parse(JSON.stringify(t)),v=g(),_=async(t,e={},a=!0)=>{var i,n;if(a)e.activeTimeout=86400,e.timeout=604800;else{const k=await K({id:e==null?void 0:e.clientId});e=k==null?void 0:k.data}const s={title:t,row:{...e},api:a?F:J,getTableList:(i=r.value)==null?void 0:i.getTableList,isAdd:a};(n=v.value)==null||n.acceptParams(s)},x=async t=>{var e;await N(D,{ids:[t.clientId]},`删除【${t.clientId}】客户端管理`),(e=r.value)==null||e.getTableList()},w=async t=>{var e,a;await N(D,{ids:t},"删除所选客户端管理"),(e=r.value)==null||e.clearSelection(),(a=r.value)==null||a.getTableList()};return(t,e)=>{const a=A("el-button"),s=H("auth");return p(),M("div",j,[C(Y,{ref_key:"proTableRef",ref:r,title:"客户端管理",indent:20,columns:L,"search-columns":h,"request-api":I,"row-key":"clientId"},{tableHeader:o(i=>[m((p(),y(a,{type:"primary",icon:b(R),onClick:e[0]||(e[0]=n=>_("新增客户端管理"))},{default:o(()=>e[1]||(e[1]=[f(" 新增 ")])),_:1},8,["icon"])),[[s,"sys.client.create"]]),m((p(),y(a,{type:"danger",icon:b(S),plain:"",disabled:!i.isSelected,onClick:n=>w(i.selectedListIds)},{default:o(()=>e[2]||(e[2]=[f(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[s,"sys.client.remove"]])]),operation:o(({row:i})=>[i.isLock==="F"?m((p(),y(a,{key:0,type:"primary",link:"",icon:b(V),onClick:n=>_("编辑客户端管理",i,!1)},{default:o(()=>e[3]||(e[3]=[f(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[s,"sys.client.update"]]):T("",!0),i.isLock==="F"?m((p(),y(a,{key:1,type:"primary",link:"",icon:b(S),onClick:n=>x(i)},{default:o(()=>e[4]||(e[4]=[f(" 删除 ")])),_:2},1032,["icon","onClick"])),[[s,"sys.client.remove"]]):T("",!0)]),_:1},512),C(B,{ref_key:"sysClientRef",ref:v},null,512)])}}});export{W as default};
