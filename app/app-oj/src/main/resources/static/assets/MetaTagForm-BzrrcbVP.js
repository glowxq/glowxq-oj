import{d as G,aB as Q,r as m,b as W,w as H,f as i,o as k,x as L,k as n,j as a,y as f,a as t,T as J,u as K,eq as X,c as q,P as Y,Q as Z,z as M,t as b,n as ee,m as oe,W as E,_ as le}from"./index-DTkCE7MD.js";import{C as U}from"./ColorSelect-DZmuTeqD.js";import{g as ae}from"./metaTagCategory-DYsFMRBy.js";const te={class:"form-preview-container"},re={class:"form-section"},ne={class:"section-header"},se={class:"color-tip"},ue={class:"preview-container"},ie={class:"preview-content"},de={class:"tag-preview-wrapper"},ce={class:"preview-examples"},pe={class:"preview-background light"},ve={class:"preview-background dark"},me={key:0,class:"color-contrast-info"},ge=G({name:"MetaTagForm",__name:"MetaTagForm",setup(we,{expose:N}){const R=Q({name:[{required:!0,message:"请填写标签名字"}],backgroundColor:[{required:!0,message:"请填写背景"}],textColor:[{required:!0,message:"请填写字体颜色"}],plain:[{required:!0,message:"请选择是否镂空"}],enable:[{required:!0,message:"请选择是否启用"}],categoryId:[{required:!0,message:"请选择所属分类"}]}),g=m(!1),o=m({title:"",row:{backgroundColor:"#009688",textColor:"#FFFFFF",plain:!0,enable:!0},api:void 0,getTableList:void 0}),C=m(""),d=m(0),w=m([]),S=async()=>{try{const l=await ae({enable:"true",page:1,limit:100});l!=null&&l.data&&(w.value=l.data.rows||[])}catch(l){console.error("获取标签分类失败",l)}},F=W(()=>{const{backgroundColor:l,textColor:e,plain:s}=o.value.row;return s?{color:l||"#009688",borderColor:l||"#009688",backgroundColor:"transparent",border:`1px solid ${l||"#009688"}`}:{color:e||"#FFFFFF",backgroundColor:l||"#009688",border:`1px solid ${l||"#009688"}`}}),$=l=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(l);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}},x=l=>{const e=$(l),s=e.r/255,u=e.g/255,p=e.b/255,c=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4),y=u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4),V=p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4);return .2126*c+.7152*y+.0722*V},_=()=>{if(!o.value.row.backgroundColor||!o.value.row.textColor)return;const l=x(o.value.row.backgroundColor),e=x(o.value.row.textColor),s=l>e?(l+.05)/(e+.05):(e+.05)/(l+.05);d.value=s},h=()=>{if(!o.value.row.backgroundColor)return;const l=x(o.value.row.backgroundColor);o.value.row.textColor=l>.5?"#000000":"#FFFFFF",_()},z=l=>{v(),_()};H(()=>[o.value.row.backgroundColor,o.value.row.textColor],()=>{_()},{deep:!0});const v=()=>{C.value=o.value.row.name||"标签预览"},P=()=>{const l=["重要","紧急","高优先级","新功能","Bug修复","测试标签","临时","待处理"],e=["#E74C3C","#3498DB","#2ECC71","#F39C12","#9B59B6","#1ABC9C","#E67E22","#34495E"],s=l[Math.floor(Math.random()*l.length)],u=e[Math.floor(Math.random()*e.length)],p=w.value.length>0?w.value[Math.floor(Math.random()*w.value.length)].id:void 0;o.value.row={...o.value.row,name:s,backgroundColor:u,categoryId:p,plain:Math.random()>.5,enable:!0},h(),v(),E.success("已自动填充测试数据")},D=l=>{o.value=l,o.value.row.backgroundColor||(o.value.row.backgroundColor="#009688"),o.value.row.textColor||(o.value.row.textColor="#FFFFFF"),(o.value.row.plain===void 0||o.value.row.plain===null)&&(o.value.row.plain=!0),(o.value.row.enable===void 0||o.value.row.enable===null)&&(o.value.row.enable=!0),v(),_(),S(),g.value=!0},B=m(),T=()=>{B.value.validate(async l=>{if(l)try{await o.value.api(o.value.row),E.success({message:`${o.value.title}成功！`}),o.value.getTableList(),g.value=!1}catch(e){console.log(e)}})};return N({acceptParams:D}),(l,e)=>{const s=i("el-icon"),u=i("el-button"),p=i("el-input"),c=i("el-form-item"),y=i("el-option"),V=i("el-select"),A=i("el-tooltip"),I=i("el-switch"),O=i("el-form"),j=i("el-dialog");return k(),L(j,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=r=>g.value=r),title:`${o.value.title}`,"destroy-on-close":!0,width:"680px",draggable:"",class:"tag-form-dialog"},{footer:n(()=>[a(u,{onClick:e[6]||(e[6]=r=>g.value=!1),class:"cancel-btn"},{default:n(()=>e[15]||(e[15]=[f(" 取消")])),_:1}),a(u,{type:"primary",onClick:T,class:"submit-btn"},{default:n(()=>e[16]||(e[16]=[f(" 确定")])),_:1})]),default:n(()=>[t("div",te,[a(O,{ref_key:"ruleFormRef",ref:B,"label-width":"120px","label-suffix":" :",rules:R,model:o.value.row,onSubmit:J(T,["prevent"]),class:"tag-form"},{default:n(()=>[t("div",re,[t("div",ne,[e[9]||(e[9]=t("h3",{class:"section-title"},"基本信息",-1)),a(u,{type:"primary",link:"",size:"small",onClick:P,class:"test-button"},{default:n(()=>[a(s,null,{default:n(()=>[a(K(X))]),_:1}),e[8]||(e[8]=f(" 一键测试 "))]),_:1})]),a(c,{label:"标签名字",prop:"name"},{default:n(()=>[a(p,{modelValue:o.value.row.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.row.name=r),placeholder:"请填写标签名字",clearable:"",onInput:v},null,8,["modelValue"])]),_:1}),a(c,{label:"所属分类",prop:"categoryId"},{default:n(()=>[a(V,{modelValue:o.value.row.categoryId,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.row.categoryId=r),placeholder:"请选择所属分类",clearable:"",style:{width:"100%"}},{default:n(()=>[(k(!0),q(Y,null,Z(w.value,r=>(k(),L(y,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e[11]||(e[11]=t("h3",{class:"section-title"},"样式设置",-1)),a(c,{label:"背景色",prop:"backgroundColor"},{default:n(()=>[a(U,{modelValue:o.value.row.backgroundColor,"onUpdate:modelValue":[e[2]||(e[2]=r=>o.value.row.backgroundColor=r),z]},null,8,["modelValue"])]),_:1}),a(c,{label:"文字颜色",prop:"textColor"},{default:n(()=>[a(U,{modelValue:o.value.row.textColor,"onUpdate:modelValue":[e[3]||(e[3]=r=>o.value.row.textColor=r),v]},null,8,["modelValue"]),t("div",se,[a(A,{content:"自动根据背景色计算文字颜色",placement:"top"},{default:n(()=>[a(u,{type:"primary",link:"",size:"small",onClick:h},{default:n(()=>e[10]||(e[10]=[f("自动计算")])),_:1})]),_:1})])]),_:1}),a(c,{label:"镂空样式",prop:"plain"},{default:n(()=>[a(I,{modelValue:o.value.row.plain,"onUpdate:modelValue":e[4]||(e[4]=r=>o.value.row.plain=r),onChange:v,"active-color":"#13ce66","inactive-color":"#dcdfe6"},null,8,["modelValue"])]),_:1}),a(c,{label:"启用",prop:"enable"},{default:n(()=>[a(I,{modelValue:o.value.row.enable,"onUpdate:modelValue":e[5]||(e[5]=r=>o.value.row.enable=r),"active-color":"#13ce66","inactive-color":"#dcdfe6"},null,8,["modelValue"])]),_:1})])]),_:1},8,["rules","model"]),t("div",ue,[e[14]||(e[14]=t("h3",{class:"preview-title"},"标签预览",-1)),t("div",ie,[t("div",de,[t("div",{class:"tag-preview",style:M(F.value)},b(C.value||"标签预览"),5)]),t("div",ce,[e[12]||(e[12]=t("p",null,"在不同背景下的效果：",-1)),t("div",pe,[t("div",{class:"tag-preview",style:M(F.value)},b(C.value||"标签预览"),5)]),t("div",ve,[t("div",{class:"tag-preview",style:M(F.value)},b(C.value||"标签预览"),5)])]),d.value?(k(),q("div",me,[t("p",null,[f("对比度: "+b(d.value.toFixed(2))+" ",1),t("span",{class:ee({pass:d.value>=4.5,warning:d.value>=3&&d.value<4.5,fail:d.value<3})},b(d.value>=4.5?"(优秀)":d.value>=3?"(一般)":"(较差)"),3)]),e[13]||(e[13]=t("p",{class:"contrast-tip"},"建议对比度大于4.5以确保可读性",-1))])):oe("",!0)])])])]),_:1},8,["modelValue","title"])}}}),_e=le(ge,[["__scopeId","data-v-ade9936d"]]);export{_e as default};
