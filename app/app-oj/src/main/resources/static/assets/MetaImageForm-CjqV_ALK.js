import{d as M,bc as C,aB as L,r as f,w as B,f as n,o as S,x as A,k as a,j as l,y as _,T as R,u as K,a as O,bZ as $,W as j,_ as E}from"./index-DTkCE7MD.js";import{E as F}from"./EnumSelect-C2fXZs6G.js";import{U as N}from"./Img-CbqiKKTP.js";const q={CAROUSEL:{code:"Carousel",name:"轮播图"},BACKGROUND:{code:"Background",name:"背景图"},AVATAR:{code:"Avatar",name:"头像"},NORMAL_IMAGE:{code:"NormalImage",name:"普通图片"},TEMP:{code:"Temp",name:"临时图片"}},P=M({name:"MetaImageForm",__name:"MetaImageForm",setup(G,{expose:c}){C();const y=L({imageKey:[{required:!0,message:"请填写图片key"}],businessType:[{required:!0,message:"请选择业务类型"}],url:[{required:!0,message:"请上传图片或填写图片URL"}],enable:[{required:!0,message:"请选择是否启用"}]}),d=f(!1),o=f({title:"",row:{},api:void 0,getTableList:void 0}),i=f([]);B(()=>o.value.row.url,r=>{if(r&&typeof r=="string"){const e=r.split(",").filter(Boolean);i.value=e.map(u=>({name:u.split("/").pop()||"image.jpg",url:u}))}else i.value=[]},{immediate:!0});const g=()=>{o.value.row.url=i.value.map(r=>r.url).join(",")},V=()=>{const r="img_",e=new Date().getTime().toString().substring(5),u=$().substring(0,8);o.value.row.imageKey=`${r}${e}_${u}`},U=r=>{o.value=r,r.title.includes("新增")&&(o.value.row.enable===void 0&&(o.value.row.enable=!0),o.value.row.sort===void 0&&(o.value.row.sort=100)),d.value=!0},b=f(),w=()=>{b.value.validate(async r=>{if(r)try{g(),await o.value.api(o.value.row),j.success({message:`${o.value.title}成功！`}),o.value.getTableList(),d.value=!1}catch(e){console.log(e)}})};return c({acceptParams:U}),(r,e)=>{const u=n("el-input"),s=n("el-form-item"),m=n("el-col"),v=n("el-button"),p=n("el-row"),k=n("el-input-number"),T=n("el-switch"),x=n("el-form"),I=n("el-dialog");return S(),A(I,{modelValue:d.value,"onUpdate:modelValue":e[9]||(e[9]=t=>d.value=t),title:`${o.value.title}`,"destroy-on-close":!0,width:"80%",draggable:""},{footer:a(()=>[l(v,{onClick:e[8]||(e[8]=t=>d.value=!1)},{default:a(()=>e[12]||(e[12]=[_("取消")])),_:1}),l(v,{type:"primary",onClick:w},{default:a(()=>e[13]||(e[13]=[_("确定")])),_:1})]),default:a(()=>[l(x,{ref_key:"ruleFormRef",ref:b,"label-width":"140px","label-suffix":" :",rules:y,model:o.value.row,onSubmit:R(w,["prevent"])},{default:a(()=>[l(p,{gutter:20},{default:a(()=>[l(m,{span:12},{default:a(()=>[l(s,{label:"图片名字",prop:"name"},{default:a(()=>[l(u,{modelValue:o.value.row.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.row.name=t),placeholder:"请填写图片名字(选填)",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:12},{default:a(()=>[l(s,{label:"图片key",prop:"imageKey"},{default:a(()=>[l(u,{modelValue:o.value.row.imageKey,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.row.imageKey=t),placeholder:"请填写图片key或点击自动生成",clearable:""},{append:a(()=>[l(v,{onClick:V},{default:a(()=>e[10]||(e[10]=[_("自动生成")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{gutter:20},{default:a(()=>[l(m,{span:12},{default:a(()=>[l(s,{label:"业务类型",prop:"businessType"},{default:a(()=>[l(F,{modelValue:o.value.row.businessType,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.row.businessType=t),"enum-data":K(q),type:"tab"},null,8,["modelValue","enum-data"])]),_:1})]),_:1}),l(m,{span:12},{default:a(()=>[l(s,{label:"排序(降序)",prop:"sort"},{default:a(()=>[l(k,{modelValue:o.value.row.sort,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.row.sort=t),precision:0,min:1,max:999999,placeholder:"选填，默认100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{gutter:20},{default:a(()=>[l(m,{span:24},{default:a(()=>[l(s,{label:"图片URL",prop:"url"},{default:a(()=>[l(N,{fileList:i.value,"onUpdate:fileList":e[4]||(e[4]=t=>i.value=t),dir:"meta/image",limit:5,useOss:!0,onChange:g},{tip:a(()=>e[11]||(e[11]=[O("div",{class:"el-upload__tip"},"支持jpg、png格式图片上传，建议尺寸1920*1080px或等比例，最多5张，每张不超过5MB",-1)])),_:1},8,["fileList"])]),_:1})]),_:1})]),_:1}),l(p,{gutter:20},{default:a(()=>[l(m,{span:12},{default:a(()=>[l(s,{label:"图片介绍",prop:"content"},{default:a(()=>[l(u,{modelValue:o.value.row.content,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.row.content=t),type:"textarea",rows:4,placeholder:"请填写图片介绍",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{span:12},{default:a(()=>[l(s,{label:"跳转链接",prop:"skipUrl"},{default:a(()=>[l(u,{modelValue:o.value.row.skipUrl,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.row.skipUrl=t),placeholder:"请填写跳转链接",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{gutter:20},{default:a(()=>[l(m,{span:12},{default:a(()=>[l(s,{label:"启用",prop:"enable"},{default:a(()=>[l(T,{modelValue:o.value.row.enable,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.row.enable=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}}),D=E(P,[["__scopeId","data-v-bbf61433"]]),H=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{q as I,D as M,H as a};
