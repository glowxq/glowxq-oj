import{w as se,d as ae,r as O,el as J,b as X,f as g,o as p,c as $,j as l,k as t,x as k,a0 as Y,m as A,bL as ie,a as N,u as v,az as pe,P as ee,Q as oe,y as V,t as z,n as me,Z as f,_ as re,h as x,aP as M,bc as ce,T as _e,ax as S,em as h,en as F,aG as G,W as ve}from"./index-DTkCE7MD.js";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang-BNLs1B-2.js";import{n as H,i as fe,a as Ve,t as ne,b as ge,c as we}from"./index-BfHlaA6M.js";import{E as be}from"./EnumSelect-C2fXZs6G.js";function B(r){var m;const y=ne(r);return(m=y==null?void 0:y.$el)!=null?m:y}const ue=we?window:void 0;function Q(...r){let m,y,i,c;if(typeof r[0]=="string"||Array.isArray(r[0])?([y,i,c]=r,m=ue):[m,y,i,c]=r,!m)return H;Array.isArray(y)||(y=[y]),Array.isArray(i)||(i=[i]);const C=[],I=()=>{C.forEach(T=>T()),C.length=0},o=(T,L,n,u)=>(T.addEventListener(L,n,u),()=>T.removeEventListener(L,n,u)),R=se(()=>[B(m),ne(c)],([T,L])=>{if(I(),!T)return;const n=Ve(L)?{...L}:L;C.push(...y.flatMap(u=>i.map(w=>o(T,u,w,n))))},{immediate:!0,flush:"post"}),q=()=>{R(),I()};return ge(q),q}let le=!1;function ye(r,m,y={}){const{window:i=ue,ignore:c=[],capture:C=!0,detectIframe:I=!1}=y;if(!i)return H;fe&&!le&&(le=!0,Array.from(i.document.body.children).forEach(n=>n.addEventListener("click",H)),i.document.documentElement.addEventListener("click",H));let o=!0;const R=n=>c.some(u=>{if(typeof u=="string")return Array.from(i.document.querySelectorAll(u)).some(w=>w===n.target||n.composedPath().includes(w));{const w=B(u);return w&&(n.target===w||n.composedPath().includes(w))}}),T=[Q(i,"click",n=>{const u=B(r);if(!(!u||u===n.target||n.composedPath().includes(u))){if(n.detail===0&&(o=!R(n)),!o){o=!0;return}m(n)}},{passive:!0,capture:C}),Q(i,"pointerdown",n=>{const u=B(r);o=!R(n)&&!!(u&&!n.composedPath().includes(u))},{passive:!0}),I&&Q(i,"blur",n=>{setTimeout(()=>{var u;const w=B(r);((u=i.document.activeElement)==null?void 0:u.tagName)==="IFRAME"&&!(w!=null&&w.contains(i.document.activeElement))&&m(n)},0)})].filter(Boolean);return()=>T.forEach(n=>n())}const Ee={class:"choose-container"},Te={class:"choose-box"},ke=["onClick"],Ie={class:"choose-box"},Le=["onClick"],Ae=ae({name:"IconChoose",__name:"index",props:{modelValue:{}},emits:["update:modelValue"],setup(r,{emit:m}){const y=r,i=m,c=O(y.modelValue),C=()=>{i("update:modelValue",c.value)},I=O("element"),o=O(""),R=Object.keys(J).map(s=>J[s].name),q=[],T=Object.assign({"/src/assets/icons/check.svg":()=>f(()=>import("./check-DP1B6a0X.js"),[]),"/src/assets/icons/class.svg":()=>f(()=>import("./class-BWbqkwWR.js"),[]),"/src/assets/icons/note.svg":()=>f(()=>import("./note-09UWJrPN.js"),[]),"/src/assets/icons/org.svg":()=>f(()=>import("./org-BNFBkAnq.js"),[]),"/src/assets/icons/phone.svg":()=>f(()=>import("./phone-AAKQdgK6.js"),[]),"/src/assets/icons/question.svg":()=>f(()=>import("./question-GcFqhxCr.js"),[]),"/src/assets/icons/scope.svg":()=>f(()=>import("./scope-DGEBm2W6.js"),[]),"/src/assets/icons/teacher.svg":()=>f(()=>import("./teacher-BaXmGp8W.js"),[]),"/src/assets/icons/time.svg":()=>f(()=>import("./time-3HTQ8mLx.js"),[]),"/src/assets/icons/topic/topic.svg":()=>f(()=>import("./topic-D9nofP3e.js"),[]),"/src/assets/icons/upcoming.svg":()=>f(()=>import("./upcoming-rqKoHiGy.js"),[]),"/src/assets/icons/work/deadline.svg":()=>f(()=>import("./deadline-lP5XD8_7.js"),[]),"/src/assets/icons/work/expiration.svg":()=>f(()=>import("./expiration-CJrgix3H.js"),[]),"/src/assets/icons/work/homework.svg":()=>f(()=>import("./homework-B09_i8xD.js"),[]),"/src/assets/icons/work/status.svg":()=>f(()=>import("./status-BIV9Wr8h.js"),[]),"/src/assets/icons/zip.svg":()=>f(()=>import("./zip-C8A8RdSL.js"),[]),"/src/assets/icons/萤火虫.svg":()=>f(()=>import("./萤火虫-DkvE-qIW.js"),[])});for(const s in T){const b=s.match(/\/assets\/icons\/([^/]+)\.svg$/);b&&b.length>=2&&q.push(`svg-${b[1]}`)}const L=X(()=>R.filter(s=>s.toLowerCase().includes(o.value.toLowerCase()))),n=X(()=>q.filter(s=>s.toLowerCase().includes(o.value.toLowerCase()))),u=O(!1),w=()=>{u.value=!0},_=()=>{u.value=!1},e=O(null);ye(e,()=>{u.value&&_()});const P=s=>{_(),c.value=s,i("update:modelValue",s)};return(s,b)=>{const D=g("el-icon"),U=g("el-input"),E=g("el-scrollbar"),j=g("el-tab-pane"),W=g("el-tabs");return p(),$("div",Ee,[l(U,ie({ref:"refInput",modelValue:c.value,"onUpdate:modelValue":b[0]||(b[0]=d=>c.value=d)},s.$attrs,{readonly:"",onInput:C,onClick:w}),{prepend:t(()=>[l(D,{size:"30"},{default:t(()=>[c.value.startsWith("svg-")?(p(),k(te,{key:0,name:c.value.substring(4)},null,8,["name"])):c.value?(p(),k(Y(c.value),{key:1})):A("",!0)]),_:1})]),_:1},16,["modelValue"]),N("div",{ref_key:"chooseDialogRef",ref:e,class:me(["choose-wrap",{show:u.value}])},[l(U,{modelValue:o.value,"onUpdate:modelValue":b[1]||(b[1]=d=>o.value=d),class:"w-50 m-2",placeholder:"搜索图标","prefix-icon":v(pe)},null,8,["modelValue","prefix-icon"]),l(W,{modelValue:I.value,"onUpdate:modelValue":b[2]||(b[2]=d=>I.value=d)},{default:t(()=>[l(j,{label:"Element",name:"element"},{default:t(()=>[l(E,{"max-height":"280"},{default:t(()=>[N("div",Te,[(p(!0),$(ee,null,oe(L.value,d=>(p(),$("div",{class:"choose-item",key:d},[N("div",{onClick:K=>P(d)},[l(D,{size:"30"},{default:t(()=>[(p(),k(Y(d)))]),_:2},1024),V(" "+z(d),1)],8,ke)]))),128))])]),_:1})]),_:1}),l(j,{label:"Svg",name:"svg"},{default:t(()=>[l(E,{"max-height":"280"},{default:t(()=>[N("div",Ie,[(p(!0),$(ee,null,oe(n.value,d=>(p(),$("div",{class:"choose-item",key:d},[N("div",{onClick:K=>P(d)},[l(D,{size:"30"},{default:t(()=>[l(te,{name:d.substring(4)},null,8,["name"])]),_:2},1024),V(" "+z(d),1)],8,Le)]))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])],2)])}}}),Ce=re(Ae,[["__scopeId","data-v-45847af7"]]),Fe=r=>x.get(M+"/sys-menu",r),Se=r=>x.post(M+"/sys-menu",r),he=r=>x.put(M+"/sys-menu",r),$e=r=>x.delete(M+"/sys-menu",r),Ne=r=>{const{id:m}=r;return x.get(M+`/sys-menu/${m}`)},Pe=r=>x.get(M+"/sys-menu/tree",r),De=r=>x.get(M+"/sys-menu/btn/exists",r,{loading:!1}),Be=r=>x.post(M+"/sys-menu/sql/export",r),ze=r=>x.post(M+"/sys-menu/sql/genButtons",r),je=r=>{const{id:m}=r;return x.put(M+`/sys-menu/datarole/change/${m}`)},Oe=ae({name:"MenuForm",__name:"MenuForm",setup(r,{expose:m}){const i=ce().getDictOptions("menu_type"),c=(_,e="")=>i[_]||e,C=O({}),I=O(!1),o=O({title:"",row:{},api:void 0,getTableList:void 0});se(()=>[o.value.row.menuTypeCd,o.value.row.isLink],_=>{const[e,P]=_;let s={pid:[{required:!0,message:"请选择上级"}],title:[{required:!0,message:"请填写名称"}],sort:[{required:!0,message:"请填写排序"}],type:[{required:!0,message:"请选择菜单类型"}]};switch(e){case S:s.icon=[{required:!0,message:"请填写图标"}],s.name=[{required:!0,message:"请填写路由名称"}],s.path=[{required:!0,message:"请填写路由地址"}],P==="T"&&(s.redirect=[{required:!0,message:"请填写外链地址"}]);break;case h:s.icon=[{required:!0,message:"请填写图标"}],P==="T"?s.redirect=[{required:!0,message:"请填写外链地址"}]:(s.name=[{required:!0,message:"请填写路由名称"}],s.path=[{required:!0,message:"请填写路由地址"}],s.component=[{required:!0,message:"请填写组件路径"}],s.permissions=[{validator:R,trigger:"blur"}]);break;case F:s.permissions=[{validator:R,trigger:"blur"}]}C.value=s,u.value&&u.value.clearValidate()});const R=(_,e,P)=>{var s;De({permissions:e,id:(s=o.value.row)==null?void 0:s.id}).then(b=>{b.data.permissionCount>0?P(new Error("权限已存在!")):P()})},q=_=>{o.value=_,!_.row.id&&!_.row.type&&(_.row.type=G.ADMIN.code),I.value=!0,L()},T=O([]),L=()=>{var _;Pe({nodeId:(_=o.value.row)==null?void 0:_.id}).then(e=>{T.value=e.data})},n={label:"title",value:"id"},u=O(),w=()=>{u.value.validate(async _=>{if(_)try{o.value.row.type||(o.value.row.type=G.ADMIN.code),await o.value.api(o.value.row),ve.success({message:`${o.value.title}成功！`}),o.value.getTableList(),I.value=!1}catch(e){console.log(e)}})};return m({acceptParams:q}),(_,e)=>{const P=g("el-tree-select"),s=g("el-form-item"),b=g("el-radio-button"),D=g("el-radio-group"),U=g("el-input"),E=g("el-col"),j=g("el-input-number"),W=g("el-row"),d=g("el-radio"),K=g("el-form"),Z=g("el-button"),de=g("el-dialog");return p(),k(de,{modelValue:I.value,"onUpdate:modelValue":e[17]||(e[17]=a=>I.value=a),title:`${o.value.title}`,"destroy-on-close":!0,width:"800px",draggable:"","append-to-body":""},{footer:t(()=>[l(Z,{onClick:e[16]||(e[16]=a=>I.value=!1)},{default:t(()=>e[28]||(e[28]=[V(" 取消 ")])),_:1}),l(Z,{type:"primary",onClick:w},{default:t(()=>e[29]||(e[29]=[V(" 确定 ")])),_:1})]),default:t(()=>[l(K,{ref_key:"ruleFormRef",ref:u,"label-width":"100px","label-suffix":" :",rules:C.value,model:o.value.row,onSubmit:_e(w,["prevent"])},{default:t(()=>[l(s,{label:"上级",prop:"pid"},{default:t(()=>[l(P,{modelValue:o.value.row.pid,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.row.pid=a),data:T.value,"check-strictly":"",placeholder:"请选择上级","render-after-expand":!1,clearable:"","default-expand-all":!0,props:n},null,8,["modelValue","data"])]),_:1}),l(s,{label:"类型",prop:"menuTypeCd"},{default:t(()=>[l(D,{modelValue:o.value.row.menuTypeCd,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.row.menuTypeCd=a)},{default:t(()=>[l(b,{value:v(S)},{default:t(()=>[V(z(c(v(S),"目录")),1)]),_:1},8,["value"]),l(b,{value:v(h)},{default:t(()=>[V(z(c(v(S),"菜单")),1)]),_:1},8,["value"]),l(b,{value:v(F)},{default:t(()=>[V(z(c(v(S),"按钮")),1)]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),o.value.row.menuTypeCd!==v(F)?(p(),k(s,{key:0,label:"图标",prop:"icon"},{default:t(()=>[l(Ce,{modelValue:o.value.row.icon,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.row.icon=a),placeholder:"请填写图标",clearable:""},null,8,["modelValue"])]),_:1})):A("",!0),l(W,{gutter:20},{default:t(()=>[l(E,{span:12},{default:t(()=>[l(s,{label:"名称",prop:"title"},{default:t(()=>[l(U,{modelValue:o.value.row.title,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.row.title=a),placeholder:"请填写名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(E,{span:12},{default:t(()=>[l(s,{label:"排序",prop:"sort"},{default:t(()=>[l(j,{modelValue:o.value.row.sort,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.row.sort=a),precision:0,min:1,max:999999},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(s,{label:"菜单类型",prop:"type"},{default:t(()=>[l(be,{modelValue:o.value.row.type,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.row.type=a),"enum-data":v(G),type:"tab",placeholder:"请选择菜单类型"},null,8,["modelValue","enum-data"])]),_:1}),l(W,{gutter:20},{default:t(()=>[o.value.row.menuTypeCd!==v(F)?(p(),k(E,{key:0,span:12},{default:t(()=>[l(s,{label:"是否外链",prop:"isLink"},{default:t(()=>[l(D,{modelValue:o.value.row.isLink,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.row.isLink=a)},{default:t(()=>[l(d,{value:"T",border:""},{default:t(()=>e[18]||(e[18]=[V(" 是 ")])),_:1}),l(d,{value:"F",border:""},{default:t(()=>e[19]||(e[19]=[V(" 否 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd!==v(F)&&o.value.row.isLink==="T"?(p(),k(E,{key:1,span:12},{default:t(()=>[l(s,{label:"外链地址",prop:"redirect"},{default:t(()=>[l(U,{modelValue:o.value.row.redirect,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.row.redirect=a),placeholder:"请填写外链地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd!==v(F)?(p(),k(E,{key:2,span:12},{default:t(()=>[l(s,{label:"路由名称",prop:"name"},{default:t(()=>[l(U,{modelValue:o.value.row.name,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.row.name=a),placeholder:"请填写路由名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd!==v(F)?(p(),k(E,{key:3,span:12},{default:t(()=>[l(s,{label:"路由地址",prop:"path"},{default:t(()=>[l(U,{modelValue:o.value.row.path,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.row.path=a),placeholder:"请填写路由地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd===v(h)?(p(),k(E,{key:4,span:12},{default:t(()=>[l(s,{label:"组件路径",prop:"component"},{default:t(()=>[l(U,{modelValue:o.value.row.component,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.row.component=a),placeholder:"请填写组件路径",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd!==v(S)?(p(),k(E,{key:5,span:12},{default:t(()=>[l(s,{label:"权限",prop:"permissions"},{default:t(()=>[l(U,{modelValue:o.value.row.permissions,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.row.permissions=a),placeholder:"请填写权限",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):A("",!0),l(E,{span:12},{default:t(()=>[l(s,{label:"显示状态",prop:"isHidden"},{default:t(()=>[l(D,{modelValue:o.value.row.isHidden,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.row.isHidden=a)},{default:t(()=>[l(d,{value:"F",border:""},{default:t(()=>e[20]||(e[20]=[V(" 显示 ")])),_:1}),l(d,{value:"T",border:""},{default:t(()=>e[21]||(e[21]=[V(" 隐藏 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o.value.row.menuTypeCd===v(h)?(p(),k(E,{key:6,span:12},{default:t(()=>[l(s,{label:"是否全屏",prop:"isFull"},{default:t(()=>[l(D,{modelValue:o.value.row.isFull,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.row.isFull=a)},{default:t(()=>[l(d,{value:"T",border:""},{default:t(()=>e[22]||(e[22]=[V(" 是 ")])),_:1}),l(d,{value:"F",border:""},{default:t(()=>e[23]||(e[23]=[V(" 否 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd===v(h)?(p(),k(E,{key:7,span:12},{default:t(()=>[l(s,{label:"固定标签页",prop:"isAffix"},{default:t(()=>[l(D,{modelValue:o.value.row.isAffix,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.row.isAffix=a)},{default:t(()=>[l(d,{value:"T",border:""},{default:t(()=>e[24]||(e[24]=[V(" 是 ")])),_:1}),l(d,{value:"F",border:""},{default:t(()=>e[25]||(e[25]=[V(" 否 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):A("",!0),o.value.row.menuTypeCd===v(h)?(p(),k(E,{key:8,span:12},{default:t(()=>[l(s,{label:"是否缓存",prop:"isKeepAlive"},{default:t(()=>[l(D,{modelValue:o.value.row.isKeepAlive,"onUpdate:modelValue":e[15]||(e[15]=a=>o.value.row.isKeepAlive=a)},{default:t(()=>[l(d,{value:"T",border:""},{default:t(()=>e[26]||(e[26]=[V(" 是 ")])),_:1}),l(d,{value:"F",border:""},{default:t(()=>e[27]||(e[27]=[V(" 否 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}}),xe=re(Oe,[["__scopeId","data-v-551c0188"]]),We=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));export{xe as M,Ne as a,Se as b,Be as c,$e as d,he as e,ze as f,Fe as g,je as h,We as i};
