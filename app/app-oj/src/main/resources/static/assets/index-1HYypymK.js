import{d as A,bc as E,r as y,f as H,g as O,o as r,c as B,j as m,k as l,i as c,x as d,u,a_ as I,y as p,a$ as v,a as g,b1 as P}from"./index-DTkCE7MD.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{_ as J,g as j,a as q,c as U,u as z,r as S}from"./HistoryList.vue_vue_type_script_setup_true_lang-DgC4OJog.js";import{u as C}from"./useHandleData-BdxQ-8Ab.js";import{_ as G}from"./SysTempFileForm.vue_vue_type_script_setup_true_lang-Dgg9Yyuy.js";import"./sortable.esm-Cw1ESr5Y.js";import"./file-Cxx7VqTf.js";import"./upload-BtJOZC1L.js";const K={class:"table-box"},M=["onClick"],le=A({name:"SysTempFileView",__name:"index",setup(Q){const b=E(),n=y(),h=[{type:"selection",width:80},{prop:"id",label:"模板标识",width:120},{prop:"tempName",label:"模版名"},{prop:"url",label:"文件",width:120},{prop:"remark",label:"备注"},{prop:"history",label:"历史"},{prop:"createId",label:"创建人",tag:!0,enum:b.getDictOptions("dynamic_user_options"),fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"createTime",label:"创建时间"},{prop:"updateId",label:"更新人",tag:!0,enum:b.getDictOptions("dynamic_user_options"),fieldNames:{label:"codeName",value:"id",tagType:"callbackShowStyle"}},{prop:"updateTime",label:"更新时间"},{prop:"operation",label:"操作",width:250,fixed:"right"}],F=[{prop:"tempName",label:"模版名",el:"input"}],N=t=>{let e=$(t);return j(e)},$=t=>{let e=JSON.parse(JSON.stringify(t));return e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},T=y(),_=async(t,e={},a=!0)=>{var i,s;if(!a){const f=await q({id:e==null?void 0:e.id});e=f==null?void 0:f.data}const o={title:t,row:{...e},api:a?U:z,getTableList:(i=n.value)==null?void 0:i.getTableList,isAdd:a};(s=T.value)==null||s.acceptParams(o)},k=y(),x=async t=>{var e;await C(S,{ids:[t.id]},`删除【${t.id}】模版文件管理`),(e=n.value)==null||e.getTableList()},L=async t=>{var e,a;await C(S,{ids:t},"删除所选模版文件管理"),(e=n.value)==null||e.clearSelection(),(a=n.value)==null||a.getTableList()},w=t=>{const e=document.createElement("a");e.style.display="none",e.href=t;const a=D(t);e.setAttribute("download",a),document.body.appendChild(e),e.click(),document.body.removeChild(e)},D=t=>{const e=/\/([^/]+)$/,a=t.match(e);return a?a[1]:""},R=t=>{var e;(e=k.value)==null||e.show(t)};return(t,e)=>{const a=H("el-button"),o=O("auth");return r(),B("div",K,[m(V,{ref_key:"proTableRef",ref:n,title:"模版文件管理",indent:20,columns:h,"search-columns":F,"request-api":N,"row-key":"id"},{tableHeader:l(i=>[c((r(),d(a,{type:"primary",icon:u(I),onClick:e[0]||(e[0]=s=>_("新增模版文件管理"))},{default:l(()=>e[1]||(e[1]=[p(" 新增 ")])),_:1},8,["icon"])),[[o,"sys.temp.file.create"]]),c((r(),d(a,{type:"danger",icon:u(v),plain:"",disabled:!i.isSelected,onClick:s=>L(i.selectedListIds)},{default:l(()=>e[2]||(e[2]=[p(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[o,"sys.temp.file.remove"]])]),url:l(({row:i})=>[g("a",{href:"#",target:"_blank",onClick:s=>w(i==null?void 0:i.url)},"下载",8,M)]),history:l(({row:i})=>[g("span",null,[m(a,{type:"primary",link:"",onClick:s=>R(i)},{default:l(()=>e[3]||(e[3]=[p(" 文件历史 ")])),_:2},1032,["onClick"])])]),operation:l(({row:i})=>[c((r(),d(a,{type:"primary",link:"",icon:u(P),onClick:s=>_("编辑模版文件管理",i,!1)},{default:l(()=>e[4]||(e[4]=[p(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[o,"sys.temp.file.update"]]),c((r(),d(a,{type:"primary",link:"",icon:u(v),onClick:s=>x(i)},{default:l(()=>e[5]||(e[5]=[p(" 删除 ")])),_:2},1032,["icon","onClick"])),[[o,"sys.temp.file.remove"]])]),_:1},512),m(G,{ref_key:"sysTempFileRef",ref:T},null,512),m(J,{ref_key:"sysTempFileHistoryListRef",ref:k},null,512)])}}});export{le as default};
