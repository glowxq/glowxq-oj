import{d as ie,p as ce,s as le,ad as re,b as d,bk as E,bl as de,f as O,g as ue,o as n,c,j as a,u as l,R as N,m as r,a as t,y as _,t as p,x as B,k as u,ds as I,n as b,z as R,T as y,bx as V,aM as pe,dv as ve,bu as me,P as _e,Q as fe,i as $,aD as ye,a$ as Te,W as z,bv as ge,_ as he}from"./index-DTkCE7MD.js";import be from"./teacher-BaXmGp8W.js";import{T as v}from"./TopicInfoStatus-BMpq3Jyc.js";import{T as L}from"./TopicType-BfRQGLIH.js";import{T as ke}from"./TopicJudgeType-B4cJ_xct.js";import{T as Ce}from"./TimeRangeType-BW_JmSm6.js";const Se={key:0,class:"topic-type-badge"},we={key:1,class:"select-checkbox"},xe={class:"card-header"},De={class:"card-content"},Ee={key:0,class:"info-row type-judge-row"},Oe={class:"info-item"},Ne={class:"info-label"},Re={class:"icon-wrapper"},$e={class:"info-value"},Le={key:1,class:"info-row"},Me={class:"info-value"},Pe={class:"time-info-container"},je={class:"time-info-header"},Ae={class:"icon-wrapper"},Be={key:0,class:"time-strategy"},Ie={class:"time-range"},Ve={key:0,class:"time-item"},ze={class:"time-value"},Ge={key:1,class:"time-item"},Je={class:"time-value"},qe={key:2,class:"no-time-set"},Fe={key:2,class:"description-container"},He={class:"description-header"},Qe={class:"icon-wrapper"},Ue={class:"description-content"},We={class:"status-row"},Ke={class:"status-tags"},Xe={key:0,class:"tags-container"},Ye={class:"card-actions"},Ze={class:"action-buttons-row"},et={class:"button-content"},tt={class:"other-actions"},st=ie({__name:"TopicCard",props:{topic:{type:Object,required:!0},isSelected:{type:Boolean,default:!1}},emits:["edit","copy","delete","doTopic","select","detail"],setup(k,{emit:G}){ce(o=>({"51b4f931":l(m),23326690:P.value,"534a3719":M.value,"3f9721cc":F.value}));const g=k,f=G,J=le(),{primary:m}=re(J),M=d(()=>E(m.value,.1)),q=d(()=>de(m.value,.1)),F=d(()=>`linear-gradient(135deg, ${M.value}, ${q.value})`),H=d(()=>`linear-gradient(135deg, ${E(m.value,.95)}, ${E(m.value,.9)})`),P=d(()=>"rgba(0, 0, 0, 0.1)"),e=d(()=>{if(typeof g.topic=="string")try{return JSON.parse(g.topic)}catch(o){return console.error("无法解析主题数据",o),{name:"数据解析错误",content:g.topic}}return g.topic}),Q=d(()=>e.value.common==="true"||e.value.common===!0),C=d(()=>e.value.enable==="true"||e.value.enable===!0),U=d(()=>{const o=j.value;return o==="disabled"?"status-unknown":o===v.NOT_STARTED.code?"status-upcoming":o===v.COMPLETED.code?"status-ended":"status-ongoing"}),j=d(()=>{const o=new Date,s=e.value.startTime?new Date(e.value.startTime):null,i=e.value.endTime?new Date(e.value.endTime):null;return C.value?s&&o<s?v.NOT_STARTED.code:i&&o>i?v.COMPLETED.code:v.IN_PROGRESS.code:"disabled"}),W=d(()=>{const o=j.value;return o==="disabled"?"已禁用":{[v.NOT_STARTED.code]:"即将开始",[v.IN_PROGRESS.code]:"进行中",[v.COMPLETED.code]:"已结束"}[o]||"未知状态"}),K=d(()=>!!e.value.topicType),X=d(()=>{if(!e.value.topicType)return"主题";const o=e.value.topicType,s=Object.values(L).find(i=>i.code===o);return s?s.name:"主题"}),Y=d(()=>Object.values(L).map(o=>o.name).join("、")),A=o=>{if(!o)return"";const s=new Date(o),i=s.getMonth()+1,x=s.getDate(),D=s.getHours().toString().padStart(2,"0"),T=s.getMinutes().toString().padStart(2,"0");return`${i}月${x}日 ${D}:${T}`},Z=o=>{o.stopPropagation(),e.value.code&&navigator.clipboard.writeText(e.value.code).then(()=>{z({message:"代码已复制到剪贴板",type:"success",duration:2e3})}).catch(()=>{z({message:"复制失败，请手动复制",type:"error",duration:2e3})})},ee=()=>{f("select",e.value)},te=()=>{f("edit",e.value)},se=()=>{f("copy",e.value)},oe=()=>{f("delete",e.value)},ae=()=>{f("doTopic",e.value)},ne=()=>{f("detail",e.value)},S=ge(),w=o=>{var s;return!!((s=S==null?void 0:S.vnode.props)!=null&&s[`on${o.charAt(0).toUpperCase()+o.slice(1)}`])};return(o,s)=>{const i=O("el-icon"),x=O("el-tooltip"),D=O("el-tag"),T=ue("auth");return n(),c("div",{class:b(["topic-card",{"is-selected":k.isSelected}]),style:R({background:H.value,boxShadow:`0 6px 16px ${P.value}`}),onClick:ee},[e.value.topicType?(n(),c("div",Se,[a(N,{enum:l(L),code:e.value.topicType,class:"type-badge-text",color:"#fff","background-color":l(m)},null,8,["enum","code","background-color"])])):r("",!0),k.isSelected?(n(),c("div",we,s[0]||(s[0]=[t("span",{class:"checkbox-icon"},"✓",-1)]))):r("",!0),t("div",{class:b(["card-status-badge",U.value])},[_(p(W.value)+" ",1),K.value?r("",!0):(n(),B(x,{key:0,content:`主题可能是：${Y.value}`,placement:"top"},{default:u(()=>[a(i,{class:"info-icon"},{default:u(()=>[a(l(I))]),_:1})]),_:1},8,["content"]))],2),t("div",xe,[t("h3",{class:"card-title",style:R({color:l(m)})},p(e.value.name||"未命名主题"),5),t("div",{class:"card-code",onClick:y(Z,["stop"])},[_(p(e.value.code||"")+" ",1),a(i,{class:"copy-icon"},{default:u(()=>[a(l(V))]),_:1})])]),t("div",De,[e.value.topicJudgeType?(n(),c("div",Ee,[t("div",Oe,[t("div",Ne,[t("div",Re,[a(i,null,{default:u(()=>[a(l(pe))]),_:1})]),s[1]||(s[1]=_(" 判题: "))]),t("div",$e,[a(N,{enum:l(ke),code:e.value.topicJudgeType,class:"enum-badge"},null,8,["enum","code"])])])])):r("",!0),e.value.principalName?(n(),c("div",Le,[s[2]||(s[2]=t("div",{class:"info-label"},[t("div",{class:"icon-wrapper"},[t("img",{src:be,class:"icon"})]),_(" 负责人: ")],-1)),t("div",Me,p(e.value.principalName||"暂无"),1)])):r("",!0),t("div",Pe,[t("div",je,[t("div",Ae,[a(i,null,{default:u(()=>[a(l(ve))]),_:1})]),s[3]||(s[3]=_(" 时间范围 ")),e.value.timeRangeType?(n(),c("span",Be,[a(N,{enum:l(Ce),code:e.value.timeRangeType,class:"enum-inline"},null,8,["enum","code"])])):r("",!0)]),t("div",Ie,[e.value.startTime?(n(),c("div",Ve,[s[4]||(s[4]=t("span",{class:"time-label"},"开始:",-1)),t("span",ze,p(A(e.value.startTime)),1)])):r("",!0),e.value.endTime?(n(),c("div",Ge,[s[5]||(s[5]=t("span",{class:"time-label"},"截止:",-1)),t("span",Je,p(A(e.value.endTime)),1)])):r("",!0),!e.value.startTime&&!e.value.endTime?(n(),c("div",qe,"未设置时间范围")):r("",!0)])]),e.value.description?(n(),c("div",Fe,[t("div",He,[t("div",Qe,[a(i,null,{default:u(()=>[a(l(me))]),_:1})]),s[6]||(s[6]=_(" 描述信息 "))]),t("div",Ue,p(e.value.description),1)])):r("",!0),t("div",We,[t("div",Ke,[t("div",{class:b(["status-tag",{"is-active":Q.value}])},s[7]||(s[7]=[t("span",{class:"tag-text"},"公共",-1)]),2),t("div",{class:b(["status-tag",{"is-active":C.value}])},s[8]||(s[8]=[t("span",{class:"tag-text"},"启用",-1)]),2)]),e.value.tagList&&e.value.tagList.length?(n(),c("div",Xe,[(n(!0),c(_e,null,fe(e.value.tagList,h=>(n(),B(D,{key:h.id,color:h.color,style:R({color:h.textColor||"#ffffff"}),class:"topic-tag",size:"small"},{default:u(()=>[_(p(h.name),1)]),_:2},1032,["color","style"]))),128))])):r("",!0)])]),t("div",Ye,[t("div",Ze,[t("button",{class:"action-button detail-button",onClick:y(ne,["stop"]),title:"查看详情"},[t("div",et,[a(i,null,{default:u(()=>[a(l(I))]),_:1}),s[9]||(s[9]=t("span",null,"查看详情",-1))])]),C.value?(n(),c("button",{key:0,class:"do-topic-button",onClick:y(ae,["stop"])}," 进入"+p(X.value),1)):r("",!0)]),t("div",tt,[w("edit")?$((n(),c("button",{key:0,class:"action-icon edit-icon",onClick:y(te,["stop"]),title:"编辑"},[a(i,null,{default:u(()=>[a(l(ye))]),_:1})])),[[T,"topic.update"]]):r("",!0),w("copy")?$((n(),c("button",{key:1,class:"action-icon copy-icon",onClick:y(se,["stop"]),title:"复制"},[a(i,null,{default:u(()=>[a(l(V))]),_:1})])),[[T,"topic.create"]]):r("",!0),w("delete")?$((n(),c("button",{key:2,class:"action-icon delete-icon",onClick:y(oe,["stop"]),title:"删除"},[a(i,null,{default:u(()=>[a(l(Te))]),_:1})])),[[T,"topic.remove"]]):r("",!0)])])],6)}}}),rt=he(st,[["__scopeId","data-v-64158239"]]);export{rt as default};
