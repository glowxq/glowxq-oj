import{d as F,r as p,f as E,g as W,o as m,c as L,j as r,k as i,i as _,x as b,u as f,a_ as G,y as n,a$ as A,D as K,b0 as Q,a as t,t as c,T as X,b1 as Y,b2 as Z,m as ee,W as N,bd as S,be as te,bf as oe,bg as le,bh as P,bi as ae,bj as ie,_ as se}from"./index-DTkCE7MD.js";import{_ as de}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as M}from"./useHandleData-BdxQ-8Ab.js";import{_ as ne}from"./CodeRecordForm.vue_vue_type_script_setup_true_lang-_SF6W9lN.js";import{I as re,d as ce,u as ue}from"./common-DxSkM119.js";import"./sortable.esm-Cw1ESr5Y.js";const pe={class:"table-box"},me={class:"code-column"},ve={class:"code-preview"},fe={class:"code-container"},_e={class:"code-info"},be={class:"info-item"},ye={class:"info-value"},Ce={class:"info-item"},ge={class:"info-value"},ke={class:"code-actions"},Te={class:"code-block"},we={key:0,class:"detail-container"},xe={class:"detail-section"},De={class:"detail-row"},Re={class:"detail-value"},Ve={class:"detail-row"},$e={class:"detail-value"},Ie={class:"detail-row"},Ee={class:"detail-value"},Le={class:"detail-section"},Ae={class:"detail-row"},Ne={class:"detail-value"},Se={class:"detail-code"},Pe={class:"code-header"},Me={class:"code-preview"},ze={class:"detail-section"},Be={class:"detail-row"},Ue={class:"detail-value"},je={class:"detail-row"},He={class:"detail-value"},Je=F({name:"CodeRecordView",__name:"index",setup(Oe){const k=p(!1),T=p(""),y=p(null),x=o=>{T.value=o.code||"",y.value=o,k.value=!0},z=()=>{navigator.clipboard.writeText(T.value).then(()=>{N.success("代码已复制到剪贴板")}).catch(()=>{N.error("复制失败，请手动复制")})},C=p(!1),s=p(null),B=o=>{o.id&&S({id:o.id}).then(e=>{e!=null&&e.data&&(s.value=e.data,C.value=!0)})},D=o=>{if(!o)return"暂无";try{return new Date(o).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}catch{return o}},v=p(),U=[{type:"selection",width:80},{prop:"userId",label:"用户id"},{prop:"name",label:"姓名"},{prop:"username",label:"用户名"},{prop:"code",label:"代码",render:o=>o.row.code||"-"},{prop:"codeMode",label:"代码模式"},{prop:"operation",label:"操作",width:330,fixed:"right"}],j=[{prop:"userId",label:"用户id",el:"input"},{prop:"name",label:"姓名",el:"input"},{prop:"username",label:"用户名",el:"input"},{prop:"code",label:"代码",el:"input"},{prop:"codeMode",label:"代码模式",el:"input"}],H=o=>{let e=R(o);return te(e)},R=o=>{let e=JSON.parse(JSON.stringify(o));return e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},V=p(),w=async(o,e={},a=!0)=>{var u,l;if(!a){const d=await S({id:e==null?void 0:e.id});e=d==null?void 0:d.data}const g={title:o,row:{...e},api:a?oe:le,getTableList:(u=v.value)==null?void 0:u.getTableList};(l=V.value)==null||l.acceptParams(g)},J=async o=>{var e;await M(P,{ids:[o.id]},`删除【${o.id}】用户代码`),(e=v.value)==null||e.getTableList()},O=async o=>{var e,a;await M(P,{ids:o},"删除所选用户代码"),(e=v.value)==null||e.clearSelection(),(a=v.value)==null||a.getTableList()},$=p(),h=()=>{var e,a;const o={title:"用户代码",templateName:"用户代码",tempApi:ce,importApi:ae,getTableList:(e=v.value)==null?void 0:e.getTableList};(a=$.value)==null||a.acceptParams(o)},q=async()=>{var e;let o=R((e=v.value)==null?void 0:e.searchParam);ue(ie,"用户代码",o)};return(o,e)=>{const a=E("el-button"),g=E("el-dialog"),u=W("auth");return m(),L("div",pe,[r(de,{ref_key:"proTableRef",ref:v,title:"用户代码",indent:20,columns:U,"search-columns":j,"request-api":H,"row-key":"id"},{tableHeader:i(l=>[_((m(),b(a,{type:"primary",icon:f(G),onClick:e[0]||(e[0]=d=>w("新增用户代码"))},{default:i(()=>e[6]||(e[6]=[n(" 新增 ")])),_:1},8,["icon"])),[[u,"code.record.create"]]),_((m(),b(a,{type:"danger",icon:f(A),plain:"",disabled:!l.isSelected,onClick:d=>O(l.selectedListIds)},{default:i(()=>e[7]||(e[7]=[n(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[u,"code.record.remove"]]),_((m(),b(a,{type:"primary",icon:f(K),plain:"",onClick:h},{default:i(()=>e[8]||(e[8]=[n(" 导入 ")])),_:1},8,["icon"])),[[u,"code.record.import"]]),_((m(),b(a,{type:"primary",icon:f(Q),plain:"",onClick:q},{default:i(()=>e[9]||(e[9]=[n(" 导出 ")])),_:1},8,["icon"])),[[u,"code.record.export"]])]),code:i(l=>[t("div",me,[t("span",ve,c(l.row.code?l.row.code.substring(0,20)+"...":""),1),r(a,{type:"primary",link:"",size:"small",onClick:X(d=>x(l.row),["stop"])},{default:i(()=>e[10]||(e[10]=[n(" 查看代码 ")])),_:2},1032,["onClick"])])]),operation:i(({row:l})=>[_((m(),b(a,{type:"primary",link:"",icon:f(Y),onClick:d=>w("编辑用户代码",l,!1)},{default:i(()=>e[11]||(e[11]=[n(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[u,"code.record.update"]]),r(a,{type:"primary",link:"",icon:f(Z),onClick:d=>B(l)},{default:i(()=>e[12]||(e[12]=[n(" 查看详情 ")])),_:2},1032,["icon","onClick"]),_((m(),b(a,{type:"primary",link:"",icon:f(A),onClick:d=>J(l)},{default:i(()=>e[13]||(e[13]=[n(" 删除 ")])),_:2},1032,["icon","onClick"])),[[u,"code.record.remove"]])]),_:1},512),r(ne,{ref_key:"codeRecordRef",ref:V},null,512),r(re,{ref_key:"ImportExcelRef",ref:$},null,512),r(g,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=l=>k.value=l),title:"代码查看",width:"80%","destroy-on-close":"",class:"code-dialog"},{default:i(()=>{var l,d,I;return[t("div",fe,[t("div",_e,[t("div",be,[e[14]||(e[14]=t("span",{class:"info-label"},"用户：",-1)),t("span",ye,c(((l=y.value)==null?void 0:l.name)||((d=y.value)==null?void 0:d.username)||"未知用户"),1)]),t("div",Ce,[e[15]||(e[15]=t("span",{class:"info-label"},"代码模式：",-1)),t("span",ge,c(((I=y.value)==null?void 0:I.codeMode)||"未知"),1)])]),t("div",ke,[r(a,{type:"primary",size:"small",onClick:z},{default:i(()=>e[16]||(e[16]=[n(" 复制代码 ")])),_:1})]),t("pre",Te,[t("code",null,c(T.value),1)])])]}),_:1},8,["modelValue"]),r(g,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=l=>C.value=l),title:"用户代码详情",width:"650px","destroy-on-close":"",class:"detail-dialog"},{footer:i(()=>[r(a,{onClick:e[3]||(e[3]=l=>C.value=!1)},{default:i(()=>e[28]||(e[28]=[n("关闭")])),_:1}),r(a,{type:"primary",onClick:e[4]||(e[4]=l=>w("编辑用户代码",s.value,!1))},{default:i(()=>e[29]||(e[29]=[n(" 编辑 ")])),_:1})]),default:i(()=>[s.value?(m(),L("div",we,[t("div",xe,[e[20]||(e[20]=t("h3",{class:"section-title"},"用户信息",-1)),t("div",De,[e[17]||(e[17]=t("div",{class:"detail-label"},"用户ID：",-1)),t("div",Re,c(s.value.userId||"暂无"),1)]),t("div",Ve,[e[18]||(e[18]=t("div",{class:"detail-label"},"姓名：",-1)),t("div",$e,c(s.value.name||"暂无"),1)]),t("div",Ie,[e[19]||(e[19]=t("div",{class:"detail-label"},"用户名：",-1)),t("div",Ee,c(s.value.username||"暂无"),1)])]),t("div",Le,[e[24]||(e[24]=t("h3",{class:"section-title"},"代码信息",-1)),t("div",Ae,[e[21]||(e[21]=t("div",{class:"detail-label"},"代码模式：",-1)),t("div",Ne,c(s.value.codeMode||"暂无"),1)]),t("div",Se,[t("div",Pe,[e[23]||(e[23]=t("span",null,"代码内容",-1)),r(a,{type:"primary",link:"",size:"small",onClick:e[2]||(e[2]=l=>x(s.value))},{default:i(()=>e[22]||(e[22]=[n(" 查看完整代码 ")])),_:1})]),t("pre",Me,c(s.value.code?s.value.code.substring(0,200)+(s.value.code.length>200?"...":""):"暂无"),1)])]),t("div",ze,[e[27]||(e[27]=t("h3",{class:"section-title"},"时间信息",-1)),t("div",Be,[e[25]||(e[25]=t("div",{class:"detail-label"},"创建时间：",-1)),t("div",Ue,c(D(s.value.createTime)),1)]),t("div",je,[e[26]||(e[26]=t("div",{class:"detail-label"},"更新时间：",-1)),t("div",He,c(D(s.value.updateTime)),1)])])])):ee("",!0)]),_:1},8,["modelValue"])])}}}),Qe=se(Je,[["__scopeId","data-v-5fdcf40f"]]);export{Qe as default};
