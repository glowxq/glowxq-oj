import{h as d,aP as c,d as A,r as D,f as P,g as h,o as p,c as V,j as g,k as r,i as u,x as m,u as y,a_ as B,y as f,a$ as R,b1 as E,m as I}from"./index-DTkCE7MD.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as C}from"./useHandleData-BdxQ-8Ab.js";import O from"./DataRoleForm-Cl0-oxMy.js";import"./sortable.esm-Cw1ESr5Y.js";const H=a=>d.get(c+"/sys-data-role",a),J=a=>d.post(c+"/sys-data-role",a),j=a=>d.put(c+"/sys-data-role",a),S=a=>d.delete(c+"/sys-data-role",a),q=a=>{const{id:l}=a;return d.get(c+`/sys-data-role/${l}`)},F=()=>d.get(c+"/sys-data-role/menu"),U={class:"table-box"},X=A({name:"SysDataRoleView",__name:"index",setup(a){const l=D(),T=[{type:"selection",width:80,selectable:t=>t.isLock!=="T"},{prop:"id",label:"编号",width:150},{prop:"roleName",label:"角色名称"},{prop:"createTime",label:"创建时间"},{prop:"updateTime",label:"修改时间"},{prop:"operation",label:"操作",width:250,fixed:"right"}],L=[{prop:"roleName",label:"角色名称",el:"input"}],x=t=>{let e=N(t);return H(e)},N=t=>JSON.parse(JSON.stringify(t)),_=D(),k=async(t,e={},s=!0)=>{var i,v;if(!s){const b=await q({id:e==null?void 0:e.id});e=b==null?void 0:b.data}const n=await F(),o={title:t,row:{...e},api:s?J:j,getTableList:(i=l.value)==null?void 0:i.getTableList,meta:n.data};(v=_.value)==null||v.acceptParams(o)},$=async t=>{var e;await C(S,{ids:[t.id]},`删除【${t.id}】数据权限`),(e=l.value)==null||e.getTableList()},w=async t=>{var e,s;await C(S,{ids:t},"删除所选数据权限"),(e=l.value)==null||e.clearSelection(),(s=l.value)==null||s.getTableList()};return(t,e)=>{const s=P("el-button"),n=h("auth");return p(),V("div",U,[g(M,{ref_key:"proTableRef",ref:l,title:"数据权限管理",indent:20,columns:T,"search-columns":L,"request-api":x,"row-key":"id"},{tableHeader:r(o=>[u((p(),m(s,{type:"primary",icon:y(B),onClick:e[0]||(e[0]=i=>k("新增数据权限角色"))},{default:r(()=>e[1]||(e[1]=[f(" 新增 ")])),_:1},8,["icon"])),[[n,"sys.data.role.create"]]),u((p(),m(s,{type:"danger",icon:y(R),plain:"",disabled:!o.isSelected,onClick:i=>w(o.selectedListIds)},{default:r(()=>e[2]||(e[2]=[f(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[n,"sys.data.role.remove"]])]),operation:r(({row:o})=>[u((p(),m(s,{type:"primary",link:"",icon:y(E),onClick:i=>k("编辑数据权限角色",o,!1)},{default:r(()=>e[3]||(e[3]=[f(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[n,"sys.data.role.update"]]),o.isLock!=="T"?u((p(),m(s,{key:0,type:"primary",link:"",icon:y(R),onClick:i=>$(o)},{default:r(()=>e[4]||(e[4]=[f(" 删除 ")])),_:2},1032,["icon","onClick"])),[[n,"sys.data.role.remove"]]):I("",!0)]),_:1},512),g(O,{ref_key:"sysDataRoleRef",ref:_},null,512)])}}});export{X as default};
