import{d as U,r as x,f as A,g as O,o as s,c as R,j as b,k as r,i as m,x as u,u as p,a_ as Y,y as d,a$ as k,b2 as H,b1 as w,aL as B,bx as F,W as o,_ as M}from"./index-DTkCE7MD.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{c as j,d as v,e as g,u as J,r as C}from"./tenant-BWmX3Yn9.js";import{u as _}from"./useHandleData-BdxQ-8Ab.js";import q from"./TenantForm-BSX-yBvC.js";import"./sortable.esm-Cw1ESr5Y.js";import"./Img-CbqiKKTP.js";import"./upload-BtJOZC1L.js";import"./ColorSelect-DZmuTeqD.js";import"./index-E5zgXN01.js";import"./style-DrPmFrlE.js";import"./FileSaver.min-BnsyPtRb.js";import"./MdPreview-CyycvVxJ.js";const W={class:"table-box"},z=U({name:"TenantView",__name:"index",setup(G){const c=x(),N=[{type:"selection",width:80},{prop:"tenantCode",label:"租户编码"},{prop:"tenantName",label:"租户名称"},{prop:"contactName",label:"联系人"},{prop:"enable",label:"状态",enum:[{label:"禁用",value:!1},{label:"正常",value:!0}],fieldNames:{label:"label",value:"value"},width:90},{prop:"expiredTime",label:"到期时间"},{prop:"maxUserNum",label:"最大用户数",width:100},{prop:"currentUserNum",label:"当前用户数",width:100},{prop:"logoUrl",label:"Logo",render:t=>t.row.logoUrl?b("img",{src:t.row.logoUrl,style:{width:"40px",height:"40px",objectFit:"contain"}},null):"-"},{prop:"themeColor",label:"主题色",width:80,render:t=>{const e=t.row.themeColor||"#009688";return b("div",{class:"color-block",style:{backgroundColor:e,width:"36px",height:"36px",borderRadius:"4px",border:"1px solid #dcdfe6",margin:"0 auto"}},null)}},{prop:"operation",label:"操作",width:250,fixed:"right"}],$=[{prop:"tenantCode",label:"租户编码",el:"input"},{prop:"tenantName",label:"租户名称",el:"input"},{prop:"contactName",label:"联系人姓名",el:"input"},{prop:"enable",label:"状态",el:"select",props:{options:[{label:"禁用",value:!1},{label:"正常",value:!0}]}},{prop:"expiredTime",label:"到期时间",el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"}}],L=t=>{let e=h(t);return j(e)},h=t=>{let e=JSON.parse(JSON.stringify(t));return e.expiredTime&&(e.expiredTimeStart=e.expiredTime[0]),e.expiredTime&&(e.expiredTimeEnd=e.expiredTime[1]),delete e.expiredTime,e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},f=x(),y=async(t,e={},a=!0)=>{var i,l;if(!a){const T=await v({id:e==null?void 0:e.id});e=T==null?void 0:T.data}const n={title:t,row:{...e},api:a?g:J,getTableList:(i=c.value)==null?void 0:i.getTableList};(l=f.value)==null||l.acceptParams(n)},D=async t=>{var e;await _(C,{ids:[t.id]},`删除【${t.tenantName}】租户`),(e=c.value)==null||e.getTableList()},I=async t=>{var e,a;await _(C,{ids:t},"删除所选租户"),(e=c.value)==null||e.clearSelection(),(a=c.value)==null||a.getTableList()},E=async t=>{var n;if(!(t!=null&&t.id)){o.error("租户ID不存在");return}const e=await v({id:t.id}),a={title:"租户详情",row:{...e==null?void 0:e.data},api:void 0,readonly:!0,getTableList:void 0};(n=f.value)==null||n.acceptParams(a)},P=async t=>{var i,l;if(!(t!=null&&t.id)){o.error("租户ID不存在");return}const e=await v({id:t.id});if(!(e!=null&&e.data)){o.error("获取租户详情失败");return}const a={...e.data};a.id=null,a.tenantId="",a.createTime=null,a.updateTime=null,a.currentUserNum=0,a.tenantCode=`${a.tenantCode}_COPY`,a.tenantName=`${a.tenantName} (复制)`;const n={title:"新增租户 (复制)",row:a,api:g,getTableList:(i=c.value)==null?void 0:i.getTableList};(l=f.value)==null||l.acceptParams(n),o.success("已复制租户信息，请修改后保存")},S=t=>{if(!(t!=null&&t.tenantId)){o.error("租户ID不存在");return}const a=`${window.location.origin}/tenant/${t.tenantId}`;navigator.clipboard.writeText(a).then(()=>{o.success(`租户【${t.tenantName}】直达链接已复制到剪贴板`)}).catch(()=>{const n=document.createElement("textarea");n.value=a,n.style.position="fixed",document.body.appendChild(n),n.select();try{document.execCommand("copy"),o.success(`租户【${t.tenantName}】直达链接已复制到剪贴板`)}catch(i){o.error("复制失败，请手动复制链接"),console.error("复制失败:",i)}document.body.removeChild(n)})};return(t,e)=>{const a=A("el-button"),n=O("auth");return s(),R("div",W,[b(V,{ref_key:"proTableRef",ref:c,title:"租户",indent:20,columns:N,"search-columns":$,"request-api":L,"row-key":"id"},{tableHeader:r(i=>[m((s(),u(a,{type:"primary",icon:p(Y),onClick:e[0]||(e[0]=l=>y("新增租户"))},{default:r(()=>e[1]||(e[1]=[d(" 新增 ")])),_:1},8,["icon"])),[[n,"tenant.create"]]),m((s(),u(a,{type:"danger",icon:p(k),plain:"",disabled:!i.isSelected,onClick:l=>I(i.selectedListIds)},{default:r(()=>e[2]||(e[2]=[d(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[n,"tenant.remove"]])]),operation:r(({row:i})=>[m((s(),u(a,{type:"primary",link:"",icon:p(H),onClick:l=>E(i)},{default:r(()=>e[3]||(e[3]=[d(" 查看 ")])),_:2},1032,["icon","onClick"])),[[n,"tenant.detail"]]),m((s(),u(a,{type:"primary",link:"",icon:p(w),onClick:l=>y("编辑租户",i,!1)},{default:r(()=>e[4]||(e[4]=[d(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[n,"tenant.update"]]),b(a,{type:"primary",link:"",icon:p(B),onClick:l=>S(i)},{default:r(()=>e[5]||(e[5]=[d(" 复制链接 ")])),_:2},1032,["icon","onClick"]),m((s(),u(a,{type:"primary",link:"",icon:p(F),onClick:l=>P(i)},{default:r(()=>e[6]||(e[6]=[d(" 复制租户 ")])),_:2},1032,["icon","onClick"])),[[n,"tenant.create"]]),m((s(),u(a,{type:"primary",link:"",icon:p(k),onClick:l=>D(i)},{default:r(()=>e[7]||(e[7]=[d(" 删除 ")])),_:2},1032,["icon","onClick"])),[[n,"tenant.remove"]])]),_:1},512),b(q,{ref_key:"tenantRef",ref:f},null,512)])}}}),pe=M(z,[["__scopeId","data-v-447e803d"]]);export{pe as default};
