import{h as u,bF as b,d as B,r as k,f as y,g as U,o as s,c as C,j as m,k as n,i as g,x as c,u as p,a_ as F,y as d,a$ as h,D as O,b0 as j,R as H,a as J,dD as K,t as q,b1 as Y,b4 as z,_ as G}from"./index-DTkCE7MD.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-v8dVln4N.js";import{u as D}from"./useHandleData-BdxQ-8Ab.js";import{I as M,M as W}from"./MetaImageForm-CjqV_ALK.js";import{I as X,d as Z,u as ee}from"./common-DxSkM119.js";import{E as te}from"./EnumSelect-C2fXZs6G.js";import"./sortable.esm-Cw1ESr5Y.js";import"./Img-CbqiKKTP.js";import"./upload-BtJOZC1L.js";const ae=i=>u.get(b+"/meta-image/list",i),ie=i=>u.post(b+"/meta-image/create",i),le=i=>u.put(b+"/meta-image/update",i),S=i=>u.delete(b+"/meta-image/remove",i),ne=i=>u.get(b+"/meta-image/detail",i),oe=(i,r)=>u.upload(b+"/meta-image/import",i,r),re=i=>u.download(b+"/meta-image/export",i),se={class:"table-box"},pe={class:"image-slot"},me={key:1},ce=B({name:"MetaImageView",__name:"index",setup(i){const r=k(),L=[{type:"selection",width:80},{prop:"name",label:"图片名字"},{prop:"imageKey",label:"图片key"},{prop:"businessType",label:"业务类型",render:t=>t.row.businessType||"-"},{prop:"url",label:"图片预览",render:t=>t.row.url||"-",width:120},{prop:"content",label:"图片介绍"},{prop:"skipUrl",label:"跳转链接"},{prop:"sort",label:"排序(降序)"},{prop:"enable",label:"启用",render:t=>t.row.enable?"启用":"禁用"},{prop:"operation",label:"操作",width:250,fixed:"right"}],A=[{prop:"name",label:"图片名字",el:"input"},{prop:"imageKey",label:"图片key",el:"input"},{prop:"businessType",label:"业务类型",render:t=>z(te,{type:"select",enumData:M,modelValue:t.searchParam.businessType,"onUpdate:modelValue":e=>{t.searchParam.businessType=e}})},{prop:"content",label:"图片介绍",el:"input"},{prop:"skipUrl",label:"跳转链接",el:"input"},{prop:"sort",label:"排序(降序)",el:"input"},{prop:"enable",label:"启用",el:"switch"}],P=t=>{let e=x(t);return ae(e)},x=t=>{let e=JSON.parse(JSON.stringify(t));return e.createTime&&(e.createTimeStart=e.createTime[0]),e.createTime&&(e.createTimeEnd=e.createTime[1]),delete e.createTime,e.updateTime&&(e.updateTimeStart=e.updateTime[0]),e.updateTime&&(e.updateTimeEnd=e.updateTime[1]),delete e.updateTime,e},I=k(),w=async(t,e={},a=!0)=>{var f,_;if(!a){const o=await ne({id:e==null?void 0:e.id});e=o==null?void 0:o.data}const T={title:t,row:{...e},api:a?ie:le,getTableList:(f=r.value)==null?void 0:f.getTableList};(_=I.value)==null||_.acceptParams(T)},R=async t=>{var e;await D(S,{ids:[t.id]},`删除【${t.id}】图片`),(e=r.value)==null||e.getTableList()},$=async t=>{var e,a;await D(S,{ids:t},"删除所选图片"),(e=r.value)==null||e.clearSelection(),(a=r.value)==null||a.getTableList()},E=k(),N=()=>{var e,a;const t={title:"图片",templateName:"图片",tempApi:Z,importApi:oe,getTableList:(e=r.value)==null?void 0:e.getTableList};(a=E.value)==null||a.acceptParams(t)},V=async()=>{var e;let t=x((e=r.value)==null?void 0:e.searchParam);ee(re,"图片",t)};return(t,e)=>{const a=y("el-button"),T=y("el-icon"),f=y("el-image"),_=y("el-tag"),o=U("auth");return s(),C("div",se,[m(Q,{ref_key:"proTableRef",ref:r,title:"图片",indent:20,columns:L,"search-columns":A,"request-api":P,"row-key":"id"},{tableHeader:n(l=>[g((s(),c(a,{type:"primary",icon:p(F),onClick:e[0]||(e[0]=v=>w("新增图片"))},{default:n(()=>e[1]||(e[1]=[d(" 新增 ")])),_:1},8,["icon"])),[[o,"meta.image.create"]]),g((s(),c(a,{type:"danger",icon:p(h),plain:"",disabled:!l.isSelected,onClick:v=>$(l.selectedListIds)},{default:n(()=>e[2]||(e[2]=[d(" 批量删除 ")])),_:2},1032,["icon","disabled","onClick"])),[[o,"meta.image.remove"]]),g((s(),c(a,{type:"primary",icon:p(O),plain:"",onClick:N},{default:n(()=>e[3]||(e[3]=[d(" 导入 ")])),_:1},8,["icon"])),[[o,"meta.image.import"]]),g((s(),c(a,{type:"primary",icon:p(j),plain:"",onClick:V},{default:n(()=>e[4]||(e[4]=[d(" 导出 ")])),_:1},8,["icon"])),[[o,"meta.image.export"]])]),businessType:n(({row:l})=>[m(H,{enum:p(M),code:l.businessType},null,8,["enum","code"])]),url:n(({row:l})=>[l.url?(s(),c(f,{key:0,src:l.url,style:{width:"100px",height:"60px","object-fit":"cover"},"preview-src-list":[l.url],fit:"cover"},{error:n(()=>[J("div",pe,[m(T,null,{default:n(()=>[m(p(K))]),_:1})])]),_:2},1032,["src","preview-src-list"])):(s(),C("span",me,"-"))]),enable:n(({row:l})=>[m(_,{type:l.enable?"success":"danger"},{default:n(()=>[d(q(l.enable?"启用":"禁用"),1)]),_:2},1032,["type"])]),operation:n(({row:l})=>[g((s(),c(a,{type:"primary",link:"",icon:p(Y),onClick:v=>w("编辑图片",l,!1)},{default:n(()=>e[5]||(e[5]=[d(" 编辑 ")])),_:2},1032,["icon","onClick"])),[[o,"meta.image.update"]]),g((s(),c(a,{type:"primary",link:"",icon:p(h),onClick:v=>R(l)},{default:n(()=>e[6]||(e[6]=[d(" 删除 ")])),_:2},1032,["icon","onClick"])),[[o,"meta.image.remove"]])]),_:1},512),m(W,{ref_key:"metaImageRef",ref:I},null,512),m(X,{ref_key:"ImportExcelRef",ref:E},null,512)])}}}),ke=G(ce,[["__scopeId","data-v-d17d9b06"]]);export{ke as default};
